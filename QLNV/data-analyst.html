<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chuyên viên phân tích dữ liệu (Data Analyst)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <style>
        :root { --main-bg: #181c2f; --sidebar-bg: #23244a; --card-bg: #23244a; --accent: #7c3aed; --accent2: #00eaff; --text: #f3f6fa; --text-muted: #b0b8d1; --border: #2e325a; --shadow: 0 4px 24px 0 rgba(44, 62, 80, 0.15); }
        body { background: var(--main-bg); color: var(--text); font-family: 'Poppins', Arial, sans-serif; margin: 0; }
        .sidebar { width: 240px; background: var(--sidebar-bg); color: var(--text); min-height: 100vh; position: fixed; top: 0; left: 0; z-index: 100; display: flex; flex-direction: column; }
        .sidebar .logo { padding: 32px 0 24px 0; text-align: center; font-size: 1.6rem; font-weight: 700; letter-spacing: 2px; color: var(--accent); }
        .sidebar .nav-item { display: flex; align-items: center; padding: 14px 32px; color: var(--text-muted); text-decoration: none; font-size: 1.08rem; border-left: 4px solid transparent; transition: background 0.2s, color 0.2s, border-color 0.2s; }
        .sidebar .nav-item.active, .sidebar .nav-item:hover { background: #1a1d36; color: var(--accent2); border-left: 4px solid var(--accent); }
        .sidebar .nav-item i { margin-right: 14px; font-size: 1.2rem; }
        .sidebar-footer { margin-top: auto; padding: 24px 32px; }
        .sidebar-footer .btn { width: 100%; background: var(--accent); color: #fff; border: none; border-radius: 8px; font-weight: 500; }
        .main-container { margin-left: 240px; min-height: 100vh; background: var(--main-bg); }
        .main-header { background: #1a1d36; border-bottom: 1px solid var(--border); padding: 20px 40px; display: flex; align-items: center; justify-content: space-between; position: sticky; top: 0; z-index: 10; }
        .main-header .user-info { display: flex; align-items: center; gap: 14px; }
        .main-header .user-info img { width: 44px; height: 44px; border-radius: 50%; object-fit: cover; border: 2px solid var(--accent); }
        .content-wrapper { padding: 40px 32px 32px 32px; max-width: 800px; margin: 0 auto; }
        .card-modern { background: var(--card-bg); border-radius: 18px; box-shadow: var(--shadow); border: 1px solid var(--border); margin-bottom: 32px; padding: 0; }
        .card-modern .card-body { padding: 32px 28px; }
        .card-modern .card-title { color: var(--accent2); font-weight: 600; font-size: 1.2rem; margin-bottom: 18px; }
        .profile-info { display: flex; align-items: center; gap: 32px; }
        .profile-info img { width: 100px; height: 100px; border-radius: 50%; object-fit: cover; border: 2px solid var(--accent); }
        .profile-info .info { font-size: 1.1rem; }
        .content-section { display: block; }
        .chart-container { position: relative; height: 300px; margin: 20px 0; }
        .chart-card { background: var(--card-bg); border-radius: 12px; padding: 20px; margin-bottom: 20px; border: 1px solid var(--border); }
        .stat-card { text-align: center; padding: 20px; background: var(--card-bg); border-radius: 12px; border: 1px solid var(--border); }
        .stat-number { font-size: 2.5rem; font-weight: bold; margin-bottom: 5px; }
        .stat-label { color: var(--text-muted); font-size: 0.9rem; }
        .trend-up { color: #28a745; }
        .trend-down { color: #dc3545; }
        .trend-stable { color: #ffc107; }
        .kpi-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .data-table { background: var(--card-bg); border-radius: 12px; overflow: hidden; }
        .table-dark { --bs-table-bg: var(--card-bg); }
        .metric-card { border-left: 4px solid var(--accent); padding: 15px; margin-bottom: 15px; background: var(--card-bg); border-radius: 8px; }
        .progress-custom { height: 8px; background: var(--border); border-radius: 4px; overflow: hidden; }
        .progress-bar-custom { height: 100%; background: linear-gradient(90deg, var(--accent), var(--accent2)); transition: width 0.3s ease; }
        @media (max-width: 900px) { .sidebar { width: 80px; } .main-container { margin-left: 80px; } .sidebar .nav-item { padding: 12px 10px; font-size: 0.95rem; } .sidebar .logo { font-size: 1.1rem; } }
        @media (max-width: 700px) { .sidebar { display: none; } .main-container { margin-left: 0; } .main-header { padding: 12px 10px; } .content-wrapper { padding: 12px 4px; } }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="logo">
            <i class="fas fa-hotel"></i> LUXSTAFF
        </div>
        <a href="#role" class="nav-item active" onclick="showSection('role')"><i class="fas fa-user-tie"></i> Vai trò</a>
        <a href="#dashboard" class="nav-item" onclick="showSection('dashboard')"><i class="fas fa-chart-line"></i> Dashboard</a>
        <a href="#reports" class="nav-item" onclick="showSection('reports')"><i class="fas fa-file-alt"></i> Báo cáo</a>
        <a href="#analytics" class="nav-item" onclick="showSection('analytics')"><i class="fas fa-chart-bar"></i> Phân tích</a>
        <a href="#predictions" class="nav-item" onclick="showSection('predictions')"><i class="fas fa-brain"></i> Dự đoán</a>
        <a href="#tools" class="nav-item" onclick="showSection('tools')"><i class="fas fa-tools"></i> Công cụ</a>
        <a href="#settings" class="nav-item" onclick="showSection('settings')"><i class="fas fa-cogs"></i> Cài đặt</a>
        <div class="sidebar-footer">
            <button class="btn" onclick="logout()"><i class="fas fa-sign-out-alt me-2"></i> Đăng xuất</button>
        </div>
    </div>
    <div class="main-container">
        <header class="main-header">
            <h1 class="h4 mb-0" style="color:var(--accent2);">Chuyên viên phân tích dữ liệu</h1>
            <div class="user-info">
                <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Avatar">
                <span><strong>Data Analyst</strong></span>
            </div>
        </header>
        <main class="content-wrapper">
            <!-- Section Vai trò (mặc định) -->
            <div id="roleSection" class="content-section">
                <!-- KPI Overview -->
                <section class="mb-4">
                    <div class="row g-3">
                        <div class="col-md-3">
                            <div class="stat-card">
                                <div class="stat-number" style="color: var(--accent2);" id="totalBookings">1,234</div>
                                <div class="stat-label">Tổng đặt phòng</div>
                                <small class="trend-up"><i class="fas fa-arrow-up"></i> +12.5%</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card">
                                <div class="stat-number" style="color: #28a745;" id="revenue">₫2.4B</div>
                                <div class="stat-label">Doanh thu tháng</div>
                                <small class="trend-up"><i class="fas fa-arrow-up"></i> +8.3%</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card">
                                <div class="stat-number" style="color: #ffc107;" id="conversionRate">3.2%</div>
                                <div class="stat-label">Tỷ lệ chuyển đổi</div>
                                <small class="trend-down"><i class="fas fa-arrow-down"></i> -0.5%</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card">
                                <div class="stat-number" style="color: #17a2b8;" id="avgBookingValue">₫1.8M</div>
                                <div class="stat-label">Giá trị TB/đơn</div>
                                <small class="trend-up"><i class="fas fa-arrow-up"></i> +5.7%</small>
                            </div>
                        </div>
                    </div>
                </section>

                <section>
                    <div class="card-modern mb-4">
                        <div class="card-body profile-info">
                            <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Avatar">
                            <div class="info">
                                <h4 class="mb-1" style="color:var(--accent2);">Chuyên viên phân tích dữ liệu (Data Analyst)</h4>
                                <div><i class="fas fa-briefcase me-2"></i> Theo dõi hiệu suất đặt phòng, xu hướng thị trường</div>
                                <hr style="border-color: var(--border); margin: 16px 0;">
                                <div>
                                    <strong style="color: var(--accent2);">Vai trò:</strong>
                                    <ul style="margin: 8px 0; padding-left: 20px;">
                                        <li>Thu thập, xử lý và phân tích dữ liệu kinh doanh từ các nguồn khác nhau</li>
                                        <li>Theo dõi và đánh giá hiệu suất đặt phòng, doanh thu, xu hướng khách hàng</li>
                                        <li>Xây dựng dashboard và báo cáo trực quan cho ban lãnh đạo</li>
                                        <li>Dự đoán xu hướng thị trường và đưa ra khuyến nghị chiến lược</li>
                                    </ul>
                                    <strong style="color: var(--accent2);">Chức năng:</strong>
                                    <ul style="margin: 8px 0; padding-left: 20px;">
                                        <li>Phân tích dữ liệu đặt phòng và hành vi khách hàng</li>
                                        <li>Theo dõi KPI và metrics quan trọng của doanh nghiệp</li>
                                        <li>Tạo báo cáo định kỳ và ad-hoc cho các phòng ban</li>
                                        <li>Phân tích xu hướng thị trường và đối thủ cạnh tranh</li>
                                        <li>Xây dựng mô hình dự đoán và machine learning</li>
                                        <li>Tối ưu hóa pricing và revenue management</li>
                                        <li>A/B testing và phân tích hiệu quả campaign</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Section Dashboard -->
            <div id="dashboardSection" class="content-section" style="display: none;">
                <div class="row g-4">
                    <!-- Real-time Metrics -->
                    <div class="col-md-8">
                        <div class="chart-card">
                            <h5 class="mb-3">Doanh thu theo thời gian thực</h5>
                            <div class="d-flex align-items-center justify-content-center" style="height: 200px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                                <div class="text-center">
                                    <i class="fas fa-chart-line fa-3x mb-3" style="color: #00eaff;"></i>
                                    <h4 style="color: #00eaff;">₫2.4B</h4>
                                    <p class="mb-0">Doanh thu tháng 8</p>
                                    <small class="text-success">+15.3% so với tháng trước</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="chart-card">
                            <h5 class="mb-3">Phân bổ đặt phòng</h5>
                            <div style="height: 200px;">
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <span><i class="fas fa-globe me-2" style="color: #7c3aed;"></i>Online</span>
                                    <span class="fw-bold">45%</span>
                                </div>
                                <div class="progress-custom mb-3">
                                    <div class="progress-bar-custom" style="width: 45%; background: #7c3aed;"></div>
                                </div>
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <span><i class="fas fa-mobile-alt me-2" style="color: #00eaff;"></i>Mobile App</span>
                                    <span class="fw-bold">30%</span>
                                </div>
                                <div class="progress-custom mb-3">
                                    <div class="progress-bar-custom" style="width: 30%; background: #00eaff;"></div>
                                </div>
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <span><i class="fas fa-phone me-2" style="color: #28a745;"></i>Phone</span>
                                    <span class="fw-bold">15%</span>
                                </div>
                                <div class="progress-custom mb-3">
                                    <div class="progress-bar-custom" style="width: 15%; background: #28a745;"></div>
                                </div>
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <span><i class="fas fa-walking me-2" style="color: #ffc107;"></i>Walk-in</span>
                                    <span class="fw-bold">10%</span>
                                </div>
                                <div class="progress-custom">
                                    <div class="progress-bar-custom" style="width: 10%; background: #ffc107;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row g-4 mt-2">
                    <div class="col-md-6">
                        <div class="chart-card">
                            <h5 class="mb-3">Top khách sạn theo doanh thu</h5>
                            <div id="topHotelsChart">
                                <div class="metric-card">
                                    <div class="d-flex justify-content-between">
                                        <span>Luxury Hotel Hanoi</span>
                                        <span class="fw-bold">₫450M</span>
                                    </div>
                                    <div class="progress-custom mt-2">
                                        <div class="progress-bar-custom" style="width: 90%"></div>
                                    </div>
                                </div>
                                <div class="metric-card">
                                    <div class="d-flex justify-content-between">
                                        <span>Grand Hotel HCMC</span>
                                        <span class="fw-bold">₫380M</span>
                                    </div>
                                    <div class="progress-custom mt-2">
                                        <div class="progress-bar-custom" style="width: 76%"></div>
                                    </div>
                                </div>
                                <div class="metric-card">
                                    <div class="d-flex justify-content-between">
                                        <span>Beach Resort Da Nang</span>
                                        <span class="fw-bold">₫320M</span>
                                    </div>
                                    <div class="progress-custom mt-2">
                                        <div class="progress-bar-custom" style="width: 64%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="chart-card">
                            <h5 class="mb-3">Xu hướng tìm kiếm</h5>
                            <div style="height: 250px;">
                                <div class="metric-card mb-2">
                                    <div class="d-flex justify-content-between">
                                        <span>Khách sạn 5*</span>
                                        <span class="fw-bold text-primary">12,500 lượt</span>
                                    </div>
                                    <div class="progress-custom mt-2">
                                        <div class="progress-bar-custom" style="width: 100%; background: #7c3aed;"></div>
                                    </div>
                                </div>
                                <div class="metric-card mb-2">
                                    <div class="d-flex justify-content-between">
                                        <span>Resort biển</span>
                                        <span class="fw-bold text-info">9,800 lượt</span>
                                    </div>
                                    <div class="progress-custom mt-2">
                                        <div class="progress-bar-custom" style="width: 78%; background: #00eaff;"></div>
                                    </div>
                                </div>
                                <div class="metric-card mb-2">
                                    <div class="d-flex justify-content-between">
                                        <span>Khách sạn city</span>
                                        <span class="fw-bold text-success">8,200 lượt</span>
                                    </div>
                                    <div class="progress-custom mt-2">
                                        <div class="progress-bar-custom" style="width: 66%; background: #28a745;"></div>
                                    </div>
                                </div>
                                <div class="metric-card mb-2">
                                    <div class="d-flex justify-content-between">
                                        <span>Homestay</span>
                                        <span class="fw-bold text-warning">6,500 lượt</span>
                                    </div>
                                    <div class="progress-custom mt-2">
                                        <div class="progress-bar-custom" style="width: 52%; background: #ffc107;"></div>
                                    </div>
                                </div>
                                <div class="metric-card">
                                    <div class="d-flex justify-content-between">
                                        <span>Villa</span>
                                        <span class="fw-bold text-danger">4,200 lượt</span>
                                    </div>
                                    <div class="progress-custom mt-2">
                                        <div class="progress-bar-custom" style="width: 34%; background: #dc3545;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- KPI Grid -->
                <div class="kpi-grid mt-4">
                    <div class="stat-card">
                        <div class="stat-number" style="color: var(--accent2);">89.2%</div>
                        <div class="stat-label">Tỷ lệ lấp đầy</div>
                        <small class="trend-up"><i class="fas fa-arrow-up"></i> +2.1%</small>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" style="color: #28a745;">4.8/5</div>
                        <div class="stat-label">Đánh giá TB</div>
                        <small class="trend-stable"><i class="fas fa-minus"></i> 0.0%</small>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" style="color: #ffc107;">2.4 ngày</div>
                        <div class="stat-label">Thời gian lưu trú TB</div>
                        <small class="trend-up"><i class="fas fa-arrow-up"></i> +0.3</small>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" style="color: #17a2b8;">₫1.2M</div>
                        <div class="stat-label">ADR (Average Daily Rate)</div>
                        <small class="trend-up"><i class="fas fa-arrow-up"></i> +4.5%</small>
                    </div>
                </div>
            </div>

            <!-- Section Báo cáo -->
            <div id="reportsSection" class="content-section" style="display: none;">
                <div class="card-modern">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h5 class="card-title">Báo cáo & Insights</h5>
                            <div>
                                <button class="btn btn-success me-2" onclick="generateReport()"><i class="fas fa-plus"></i> Tạo báo cáo</button>
                                <button class="btn btn-info" onclick="scheduleReport()"><i class="fas fa-clock"></i> Lên lịch</button>
                            </div>
                        </div>

                        <!-- Bộ lọc báo cáo -->
                        <div class="row mb-4">
                            <div class="col-md-3">
                                <select class="form-control" id="reportType">
                                    <option value="">Loại báo cáo</option>
                                    <option value="revenue">Doanh thu</option>
                                    <option value="booking">Đặt phòng</option>
                                    <option value="customer">Khách hàng</option>
                                    <option value="performance">Hiệu suất</option>
                                    <option value="market">Thị trường</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <select class="form-control" id="reportPeriod">
                                    <option value="today">Hôm nay</option>
                                    <option value="week">Tuần này</option>
                                    <option value="month" selected>Tháng này</option>
                                    <option value="quarter">Quý này</option>
                                    <option value="year">Năm này</option>
                                    <option value="custom">Tùy chọn</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <input type="text" class="form-control" id="reportSearch" placeholder="Tìm kiếm báo cáo...">
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-outline-secondary w-100" onclick="exportReports()">Xuất Excel</button>
                            </div>
                        </div>

                        <!-- Danh sách báo cáo -->
                        <div class="data-table">
                            <table class="table table-dark table-hover">
                                <thead>
                                    <tr>
                                        <th>Tên báo cáo</th>
                                        <th>Loại</th>
                                        <th>Thời gian</th>
                                        <th>Trạng thái</th>
                                        <th>Tạo lúc</th>
                                        <th>Thao tác</th>
                                    </tr>
                                </thead>
                                <tbody id="reportsTableBody">
                                    <tr>
                                        <td>Báo cáo doanh thu tháng 8</td>
                                        <td><span class="badge bg-success">Doanh thu</span></td>
                                        <td>01/08 - 31/08/2025</td>
                                        <td><span class="badge bg-primary">Hoàn thành</span></td>
                                        <td>03/08/2025 09:30</td>
                                        <td>
                                            <button class="btn btn-sm btn-info me-1" title="Xem"><i class="fas fa-eye"></i></button>
                                            <button class="btn btn-sm btn-success me-1" title="Tải"><i class="fas fa-download"></i></button>
                                            <button class="btn btn-sm btn-warning me-1" title="Chia sẻ"><i class="fas fa-share"></i></button>
                                            <button class="btn btn-sm btn-danger" title="Xóa"><i class="fas fa-trash"></i></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Phân tích hành vi khách hàng Q3</td>
                                        <td><span class="badge bg-info">Khách hàng</span></td>
                                        <td>01/07 - 30/09/2025</td>
                                        <td><span class="badge bg-warning">Đang xử lý</span></td>
                                        <td>02/08/2025 14:20</td>
                                        <td>
                                            <button class="btn btn-sm btn-secondary me-1" title="Xem" disabled><i class="fas fa-eye"></i></button>
                                            <button class="btn btn-sm btn-secondary me-1" title="Tải" disabled><i class="fas fa-download"></i></button>
                                            <button class="btn btn-sm btn-warning me-1" title="Hủy"><i class="fas fa-times"></i></button>
                                            <button class="btn btn-sm btn-danger" title="Xóa"><i class="fas fa-trash"></i></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Phân tích -->
            <div id="analyticsSection" class="content-section" style="display: none;">
                <div class="row g-4">
                    <!-- Customer Segmentation -->
                    <div class="col-md-6">
                        <div class="chart-card">
                            <h5 class="mb-3">Phân khúc khách hàng</h5>
                            <div class="row text-center">
                                <div class="col-6 mb-3">
                                    <div style="background: #7c3aed; border-radius: 50%; width: 80px; height: 80px; margin: 0 auto; display: flex; align-items: center; justify-content: center;">
                                        <span class="h4 mb-0 text-white">35%</span>
                                    </div>
                                    <small class="mt-2 d-block">Business</small>
                                </div>
                                <div class="col-6 mb-3">
                                    <div style="background: #00eaff; border-radius: 50%; width: 80px; height: 80px; margin: 0 auto; display: flex; align-items: center; justify-content: center;">
                                        <span class="h4 mb-0 text-dark">40%</span>
                                    </div>
                                    <small class="mt-2 d-block">Leisure</small>
                                </div>
                                <div class="col-6">
                                    <div style="background: #28a745; border-radius: 50%; width: 80px; height: 80px; margin: 0 auto; display: flex; align-items: center; justify-content: center;">
                                        <span class="h4 mb-0 text-white">15%</span>
                                    </div>
                                    <small class="mt-2 d-block">Group</small>
                                </div>
                                <div class="col-6">
                                    <div style="background: #ffc107; border-radius: 50%; width: 80px; height: 80px; margin: 0 auto; display: flex; align-items: center; justify-content: center;">
                                        <span class="h4 mb-0 text-dark">10%</span>
                                    </div>
                                    <small class="mt-2 d-block">Family</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Booking Pattern -->
                    <div class="col-md-6">
                        <div class="chart-card">
                            <h5 class="mb-3">Mẫu đặt phòng theo giờ</h5>
                            <div class="text-center">
                                <i class="fas fa-clock fa-3x mb-3" style="color: #28a745;"></i>
                                <h4 style="color: #28a745;">Peak: 16:00 - 20:00</h4>
                                <p class="mb-2">42 đặt phòng/giờ</p>
                                <div class="row text-center mt-3">
                                    <div class="col-4">
                                        <small>Sáng</small>
                                        <div class="h6">20 đặt/giờ</div>
                                    </div>
                                    <div class="col-4">
                                        <small>Chiều</small>
                                        <div class="h6 text-warning">42 đặt/giờ</div>
                                    </div>
                                    <div class="col-4">
                                        <small>Tối</small>
                                        <div class="h6">15 đặt/giờ</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Advanced Analytics -->
                <div class="row g-4 mt-2">
                    <div class="col-md-8">
                        <div class="chart-card">
                            <h5 class="mb-3">Phân tích Cohort - Retention Rate</h5>
                            <div class="table-responsive">
                                <table class="table table-dark table-sm">
                                    <thead>
                                        <tr>
                                            <th>Tháng</th>
                                            <th>Month 0</th>
                                            <th>Month 1</th>
                                            <th>Month 2</th>
                                            <th>Month 3</th>
                                            <th>Month 4</th>
                                            <th>Month 5</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Jan 2025</td>
                                            <td class="bg-success">100%</td>
                                            <td class="bg-warning">65%</td>
                                            <td class="bg-warning">45%</td>
                                            <td class="bg-info">32%</td>
                                            <td class="bg-info">28%</td>
                                            <td class="bg-secondary">25%</td>
                                        </tr>
                                        <tr>
                                            <td>Feb 2025</td>
                                            <td class="bg-success">100%</td>
                                            <td class="bg-warning">68%</td>
                                            <td class="bg-warning">48%</td>
                                            <td class="bg-info">35%</td>
                                            <td class="bg-info">30%</td>
                                            <td>-</td>
                                        </tr>
                                        <tr>
                                            <td>Mar 2025</td>
                                            <td class="bg-success">100%</td>
                                            <td class="bg-warning">72%</td>
                                            <td class="bg-warning">52%</td>
                                            <td class="bg-info">38%</td>
                                            <td>-</td>
                                            <td>-</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="chart-card">
                            <h5 class="mb-3">Funnel chuyển đổi</h5>
                            <div class="funnel-chart">
                                <div class="funnel-stage" style="width: 100%; background: var(--accent2);">
                                    <span>Lượt truy cập: 10,000</span>
                                </div>
                                <div class="funnel-stage mt-2" style="width: 60%; background: #28a745;">
                                    <span>Xem chi tiết: 6,000</span>
                                </div>
                                <div class="funnel-stage mt-2" style="width: 25%; background: #ffc107;">
                                    <span>Thêm giỏ hàng: 2,500</span>
                                </div>
                                <div class="funnel-stage mt-2" style="width: 15%; background: #dc3545;">
                                    <span>Thanh toán: 1,500</span>
                                </div>
                                <div class="funnel-stage mt-2" style="width: 12%; background: var(--accent);">
                                    <span>Hoàn thành: 1,200</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Dự đoán -->
            <div id="predictionsSection" class="content-section" style="display: none;">
                <div class="row g-4">
                    <div class="col-md-8">
                        <div class="chart-card">
                            <h5 class="mb-3">Dự đoán doanh thu 6 tháng tới</h5>
                            <div class="d-flex align-items-center justify-content-center" style="height: 200px; background: rgba(255,193,7,0.1); border-radius: 8px;">
                                <div class="text-center">
                                    <i class="fas fa-chart-line fa-3x mb-3" style="color: #ffc107;"></i>
                                    <h4 style="color: #ffc107;">Tăng trưởng 15%</h4>
                                    <p class="mb-1">Dự đoán doanh thu tháng 12: <strong>₫4.2B</strong></p>
                                    <small class="text-muted">Sử dụng mô hình ARIMA + Machine Learning</small>
                                </div>
                            </div>
                            <div class="mt-3">
                                <div class="row text-center">
                                    <div class="col-2">
                                        <small>Sep</small>
                                        <div class="fw-bold">₫2.8B</div>
                                    </div>
                                    <div class="col-2">
                                        <small>Oct</small>
                                        <div class="fw-bold">₫3.1B</div>
                                    </div>
                                    <div class="col-2">
                                        <small>Nov</small>
                                        <div class="fw-bold">₫3.5B</div>
                                    </div>
                                    <div class="col-2">
                                        <small>Dec</small>
                                        <div class="fw-bold text-warning">₫4.2B</div>
                                    </div>
                                    <div class="col-2">
                                        <small>Jan</small>
                                        <div class="fw-bold">₫3.8B</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="chart-card">
                            <h5 class="mb-3">Confidence Intervals</h5>
                            <div class="prediction-stats">
                                <div class="metric-card">
                                    <strong>Dự đoán tháng 9:</strong>
                                    <div>₫2.8B ± ₫0.3B</div>
                                    <small class="text-success">Độ tin cậy: 85%</small>
                                </div>
                                <div class="metric-card">
                                    <strong>Xu hướng:</strong>
                                    <div class="trend-up">Tăng trưởng 15%</div>
                                    <small>So với cùng kỳ năm trước</small>
                                </div>
                                <div class="metric-card">
                                    <strong>Peak season:</strong>
                                    <div>Tháng 12 - Tháng 2</div>
                                    <small>Dự kiến +45% booking</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Seasonal Analysis -->
                <div class="row g-4 mt-2">
                    <div class="col-md-6">
                        <div class="chart-card">
                            <h5 class="mb-3">Phân tích mùa vụ</h5>
                            <div class="text-center" style="height: 200px; display: flex; align-items: center; justify-content: center;">
                                <div>
                                    <i class="fas fa-calendar-alt fa-3x mb-3" style="color: #7c3aed;"></i>
                                    <h6>Phân tích theo quý</h6>
                                    <div class="row mt-3">
                                        <div class="col-6">
                                            <div class="small">Q1: 70%</div>
                                            <div class="small">Q2: 85%</div>
                                        </div>
                                        <div class="col-6">
                                            <div class="small">Q3: 90%</div>
                                            <div class="small text-warning">Q4: 100%</div>
                                        </div>
                                    </div>
                                    <small class="text-muted mt-2 d-block">Peak season: Q4</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="chart-card">
                            <h5 class="mb-3">Dự đoán xu hướng tìm kiếm</h5>
                            <div class="search-predictions">
                                <div class="prediction-item">
                                    <div class="d-flex justify-content-between">
                                        <span>"Khách sạn biển"</span>
                                        <span class="trend-up">+25%</span>
                                    </div>
                                    <small class="text-muted">Peak: Tháng 7-8</small>
                                </div>
                                <div class="prediction-item">
                                    <div class="d-flex justify-content-between">
                                        <span>"Resort nghỉ dưỡng"</span>
                                        <span class="trend-up">+18%</span>
                                    </div>
                                    <small class="text-muted">Peak: Tháng 12-1</small>
                                </div>
                                <div class="prediction-item">
                                    <div class="d-flex justify-content-between">
                                        <span>"Khách sạn city"</span>
                                        <span class="trend-stable">+5%</span>
                                    </div>
                                    <small class="text-muted">Ổn định</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Công cụ -->
            <div id="toolsSection" class="content-section" style="display: none;">
                <div class="row g-4">
                    <div class="col-md-6">
                        <div class="chart-card">
                            <h5 class="mb-3">Data Query Builder</h5>
                            <div class="mb-3">
                                <label class="form-label">Chọn bảng dữ liệu:</label>
                                <select class="form-control" id="dataTable">
                                    <option value="bookings">Bookings</option>
                                    <option value="customers">Customers</option>
                                    <option value="hotels">Hotels</option>
                                    <option value="reviews">Reviews</option>
                                    <option value="payments">Payments</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Điều kiện lọc:</label>
                                <textarea class="form-control" id="queryConditions" rows="3" placeholder="WHERE created_date >= '2025-01-01'"></textarea>
                            </div>
                            <button class="btn btn-primary" onclick="executeQuery()">Thực thi Query</button>
                            <button class="btn btn-success ms-2" onclick="exportQueryResult()">Xuất kết quả</button>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="chart-card">
                            <h5 class="mb-3">A/B Testing Tool</h5>
                            <div class="mb-3">
                                <label class="form-label">Tên experiment:</label>
                                <input type="text" class="form-control" id="experimentName" placeholder="VD: New Booking Flow">
                            </div>
                            <div class="row mb-3">
                                <div class="col-6">
                                    <label class="form-label">Variant A (Control):</label>
                                    <input type="text" class="form-control" placeholder="Current design">
                                </div>
                                <div class="col-6">
                                    <label class="form-label">Variant B (Test):</label>
                                    <input type="text" class="form-control" placeholder="New design">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Traffic split:</label>
                                <input type="range" class="form-range" min="10" max="90" value="50" id="trafficSplit">
                                <small class="text-muted">50% - 50%</small>
                            </div>
                            <button class="btn btn-success" onclick="startExperiment()">Bắt đầu Test</button>
                            <button class="btn btn-info ms-2" onclick="viewExperiments()">Xem kết quả</button>
                        </div>
                    </div>
                </div>

                <div class="row g-4 mt-2">
                    <div class="col-md-12">
                        <div class="chart-card">
                            <h5 class="mb-3">Data Import/Export Tools</h5>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="border rounded p-3 text-center">
                                        <i class="fas fa-file-csv fa-2x mb-2" style="color: var(--accent2);"></i>
                                        <h6>Import CSV</h6>
                                        <input type="file" class="form-control mb-2" accept=".csv">
                                        <button class="btn btn-sm btn-primary">Upload</button>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="border rounded p-3 text-center">
                                        <i class="fas fa-database fa-2x mb-2" style="color: #28a745;"></i>
                                        <h6>Database Backup</h6>
                                        <select class="form-control mb-2">
                                            <option>Full backup</option>
                                            <option>Incremental</option>
                                        </select>
                                        <button class="btn btn-sm btn-success">Backup</button>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="border rounded p-3 text-center">
                                        <i class="fas fa-chart-pie fa-2x mb-2" style="color: #ffc107;"></i>
                                        <h6>Auto Reports</h6>
                                        <select class="form-control mb-2">
                                            <option>Daily</option>
                                            <option>Weekly</option>
                                            <option>Monthly</option>
                                        </select>
                                        <button class="btn btn-sm btn-warning">Schedule</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Cài đặt -->
            <div id="settingsSection" class="content-section" style="display: none;">
                <div class="card-modern">
                    <div class="card-body">
                        <h5 class="card-title">Cài đặt Data Analytics</h5>
                        
                        <div class="row g-4">
                            <!-- Cài đặt Dashboard -->
                            <div class="col-md-6">
                                <div class="chart-card">
                                    <h6><i class="fas fa-chart-line me-2"></i>Cài đặt Dashboard</h6>
                                    <div class="form-check form-switch mb-3">
                                        <input class="form-check-input" type="checkbox" id="realTimeUpdate" checked>
                                        <label class="form-check-label" for="realTimeUpdate">
                                            Cập nhật real-time
                                        </label>
                                    </div>
                                    <div class="form-check form-switch mb-3">
                                        <input class="form-check-input" type="checkbox" id="autoRefresh" checked>
                                        <label class="form-check-label" for="autoRefresh">
                                            Tự động làm mới (5 phút)
                                        </label>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Số metrics hiển thị</label>
                                        <select class="form-control" id="metricCount">
                                            <option value="8">8 metrics</option>
                                            <option value="12" selected>12 metrics</option>
                                            <option value="16">16 metrics</option>
                                        </select>
                                    </div>
                                    <button class="btn btn-primary">Lưu cài đặt</button>
                                </div>
                            </div>

                            <!-- Cài đặt Báo cáo -->
                            <div class="col-md-6">
                                <div class="chart-card">
                                    <h6><i class="fas fa-file-alt me-2"></i>Cài đặt Báo cáo</h6>
                                    <div class="mb-3">
                                        <label class="form-label">Email nhận báo cáo</label>
                                        <input type="email" class="form-control" value="analyst@luxhaven.com">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Tần suất gửi báo cáo</label>
                                        <select class="form-control">
                                            <option value="daily" selected>Hàng ngày</option>
                                            <option value="weekly">Hàng tuần</option>
                                            <option value="monthly">Hàng tháng</option>
                                        </select>
                                    </div>
                                    <div class="form-check form-switch mb-3">
                                        <input class="form-check-input" type="checkbox" id="includeCharts" checked>
                                        <label class="form-check-label" for="includeCharts">
                                            Bao gồm biểu đồ
                                        </label>
                                    </div>
                                    <button class="btn btn-success">Cập nhật</button>
                                </div>
                            </div>
                        </div>

                        <!-- Cài đặt Data Sources -->
                        <div class="row g-4 mt-2">
                            <div class="col-md-12">
                                <div class="chart-card">
                                    <h6><i class="fas fa-database me-2"></i>Nguồn dữ liệu</h6>
                                    <div class="table-responsive">
                                        <table class="table table-dark table-sm">
                                            <thead>
                                                <tr>
                                                    <th>Nguồn</th>
                                                    <th>Trạng thái</th>
                                                    <th>Lần cập nhật cuối</th>
                                                    <th>Frequency</th>
                                                    <th>Thao tác</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td><i class="fas fa-database me-2"></i>Main Database</td>
                                                    <td><span class="badge bg-success">Connected</span></td>
                                                    <td>2 phút trước</td>
                                                    <td>Real-time</td>
                                                    <td><button class="btn btn-sm btn-info">Test</button></td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fab fa-google me-2"></i>Google Analytics</td>
                                                    <td><span class="badge bg-success">Connected</span></td>
                                                    <td>15 phút trước</td>
                                                    <td>Hourly</td>
                                                    <td><button class="btn btn-sm btn-info">Test</button></td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fab fa-facebook me-2"></i>Facebook Ads</td>
                                                    <td><span class="badge bg-warning">Syncing</span></td>
                                                    <td>1 giờ trước</td>
                                                    <td>Daily</td>
                                                    <td><button class="btn btn-sm btn-warning">Retry</button></td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-shopping-cart me-2"></i>Payment Gateway</td>
                                                    <td><span class="badge bg-success">Connected</span></td>
                                                    <td>5 phút trước</td>
                                                    <td>Real-time</td>
                                                    <td><button class="btn btn-sm btn-info">Test</button></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Quản lý hiển thị section
        window.showSection = function(sectionName) {
            // Ẩn tất cả sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Hiển thị section được chọn
            document.getElementById(sectionName + 'Section').style.display = 'block';
            
            // Cập nhật active state cho menu
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            // Cập nhật tiêu đề header
            const titles = {
                'role': 'Chuyên viên phân tích dữ liệu',
                'dashboard': 'Analytics Dashboard',
                'reports': 'Báo cáo & Insights',
                'analytics': 'Phân tích nâng cao',
                'predictions': 'Dự đoán & Forecasting',
                'tools': 'Công cụ phân tích',
                'settings': 'Cài đặt hệ thống'
            };
            document.querySelector('.main-header h1').textContent = titles[sectionName];
        };

        // Các hàm chức năng
        window.generateReport = function() {
            alert('Tạo báo cáo mới - Sẽ mở form tạo báo cáo tùy chỉnh');
        };

        window.scheduleReport = function() {
            alert('Lên lịch báo cáo tự động - Thiết lập thời gian và tần suất gửi báo cáo');
        };

        window.exportReports = function() {
            alert('Xuất báo cáo Excel - Tải xuống file Excel chứa tất cả báo cáo');
        };

        window.executeQuery = function() {
            const table = document.getElementById('dataTable') ? document.getElementById('dataTable').value : '';
            const conditions = document.getElementById('queryConditions') ? document.getElementById('queryConditions').value : '';
            alert(`Thực thi query trên bảng: ${table || 'Chưa chọn'}\nĐiều kiện: ${conditions || 'Không có'}`);
        };

        window.exportQueryResult = function() {
            alert('Xuất kết quả query ra file CSV/Excel');
        };

        window.startExperiment = function() {
            const experimentName = document.getElementById('experimentName') ? document.getElementById('experimentName').value : '';
            if (experimentName) {
                alert(`Bắt đầu A/B test: ${experimentName}`);
            } else {
                alert('Vui lòng nhập tên experiment');
            }
        };

        window.viewExperiments = function() {
            alert('Xem kết quả các A/B tests đang chạy và đã hoàn thành');
        };

        // Cập nhật traffic split display
        const trafficSlider = document.getElementById('trafficSplit');
        if (trafficSlider) {
            trafficSlider.addEventListener('input', function() {
                const value = this.value;
                const nextEl = this.nextElementSibling;
                if (nextEl) {
                    nextEl.textContent = `${value}% - ${100-value}%`;
                }
            });
        }

        // Simulate real-time data updates
        function updateRealTimeStats() {
            const elements = ['totalBookings', 'revenue', 'conversionRate', 'avgBookingValue'];
            elements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    // Add slight animation effect
                    element.style.transition = 'color 0.3s ease';
                    element.style.color = '#00eaff';
                    setTimeout(() => {
                        element.style.color = '#f3f6fa';
                    }, 300);
                }
            });
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Show role section by default
            showSection('role');
            
            // Update real-time stats every 30 seconds
            setInterval(updateRealTimeStats, 30000);
        });

        // Export functions for PDF/Excel
        window.exportToPDF = function() {
            alert('Xuất báo cáo PDF - Tất cả dữ liệu sẽ được bao gồm');
        };

        window.exportToExcel = function() {
            alert('Xuất dữ liệu Excel - Bao gồm raw data và summary');
        };

        // Search and filter functions
        window.searchData = function() {
            const searchTerm = document.getElementById('dataSearch') ? document.getElementById('dataSearch').value : '';
            alert(`Tìm kiếm dữ liệu: ${searchTerm || 'Trống'}`);
        };

        window.filterByDate = function() {
            const fromDate = document.getElementById('fromDate') ? document.getElementById('fromDate').value : '';
            const toDate = document.getElementById('toDate') ? document.getElementById('toDate').value : '';
            alert(`Lọc dữ liệu từ ${fromDate || 'N/A'} đến ${toDate || 'N/A'}`);
        };
    </script>
</body>
</html>
                   
            <style>
                .funnel-stage {
                    height: 40px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    font-weight: 500;
                    border-radius: 4px;
                    margin: 0 auto;
                    transition: all 0.3s ease;
                }
                .funnel-stage:hover {
                    transform: scale(1.02);
                }
                .prediction-item {
                    padding: 10px;
                    border-bottom: 1px solid var(--border);
                    margin-bottom: 10px;
                }
                .prediction-item:last-child {
                    border-bottom: none;
                    margin-bottom: 0;
                }
            </style>
        `);

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDuX4_RKARM7g0K3BvoZPS8ADxVgrYQKYc",
            authDomain: "websitedatphongkhachsan.firebaseapp.com",
            databaseURL: "https://websitedatphongkhachsan-default-rtdb.firebaseio.com",
            projectId: "websitedatphongkhachsan",
            storageBucket: "websitedatphongkhachsan.appspot.com",
            messagingSenderId: "732884739524",
            appId: "1:732884739524:web:a9c34746f5704a9c3eb091",
            measurementId: "G-RC61EXTZH7"
        };

        // Khởi tạo Firebase
        firebase.initializeApp(firebaseConfig);

        // Đăng xuất với Firebase Auth
        function logout() {
            if (confirm('Bạn có chắc chắn muốn đăng xuất?')) {
                // Kiểm tra xem Firebase Auth có sẵn không
                if (typeof firebase !== 'undefined' && firebase.auth) {
                    firebase.auth().signOut().then(() => {
                        console.log('Đăng xuất thành công');
                        window.location.href = '../auth.html';
                    }).catch((error) => {
                        console.error('Lỗi đăng xuất:', error);
                        // Vẫn chuyển trang nếu có lỗi
                        window.location.href = '../auth.html';
                    });
                } else {
                    // Fallback nếu Firebase không có
                    window.location.href = '../auth.html';
                }
            }
        }
    </script>
</body>
</html>
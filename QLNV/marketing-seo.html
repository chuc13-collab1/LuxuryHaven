<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nh√¢n vi√™n marketing / SEO</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <style>
        :root { --main-bg: #181c2f; --sidebar-bg: #23244a; --card-bg: #23244a; --accent: #7c3aed; --accent2: #00eaff; --text: #f3f6fa; --text-muted: #b0b8d1; --border: #2e325a; --shadow: 0 4px 24px 0 rgba(44, 62, 80, 0.15); }
        body { background: var(--main-bg); color: var(--text); font-family: 'Poppins', Arial, sans-serif; margin: 0; }
        .sidebar { width: 240px; background: var(--sidebar-bg); color: var(--text); min-height: 100vh; position: fixed; top: 0; left: 0; z-index: 100; display: flex; flex-direction: column; }
        .sidebar .logo { padding: 32px 0 24px 0; text-align: center; font-size: 1.6rem; font-weight: 700; letter-spacing: 2px; color: var(--accent); }
        .sidebar .nav-item { display: flex; align-items: center; padding: 14px 32px; color: var(--text-muted); text-decoration: none; font-size: 1.08rem; border-left: 4px solid transparent; transition: background 0.2s, color 0.2s, border-color 0.2s; }
        .sidebar .nav-item.active, .sidebar .nav-item:hover { background: #1a1d36; color: var(--accent2); border-left: 4px solid var(--accent); }
        .sidebar .nav-item i { margin-right: 14px; font-size: 1.2rem; }
        .sidebar-footer { margin-top: auto; padding: 24px 32px; }
        .sidebar-footer .btn { width: 100%; background: var(--accent); color: #fff; border: none; border-radius: 8px; font-weight: 500; }
        .main-container { margin-left: 240px; min-height: 100vh; background: var(--main-bg); }
        .main-header { background: #1a1d36; border-bottom: 1px solid var(--border); padding: 20px 40px; display: flex; align-items: center; justify-content: space-between; position: sticky; top: 0; z-index: 10; }
        .main-header .user-info { display: flex; align-items: center; gap: 14px; }
        .main-header .user-info img { width: 44px; height: 44px; border-radius: 50%; object-fit: cover; border: 2px solid var(--accent); }
        .content-wrapper { padding: 40px 32px 32px 32px; }
        .card-modern { background: var(--card-bg); border-radius: 18px; box-shadow: var(--shadow); border: 1px solid var(--border); margin-bottom: 32px; padding: 0; }
        .card-modern .card-body { padding: 32px 28px; }
        .card-modern .card-title { color: var(--accent2); font-weight: 600; font-size: 1.2rem; margin-bottom: 18px; }
        .profile-info { display: flex; align-items: center; gap: 32px; }
        .profile-info img { width: 100px; height: 100px; border-radius: 50%; object-fit: cover; border: 2px solid var(--accent); }
        .profile-info .info { font-size: 1.1rem; }

        /* New styles for marketing/SEO */
        .content-section { display: none; }
        .content-section.active { display: block; }
        .stat-card { background: var(--card-bg); border-radius: 12px; padding: 24px; border: 1px solid var(--border); text-align: center; }
        .stat-number { font-size: 2rem; font-weight: 700; margin-bottom: 8px; }
        .stat-label { color: var(--text-muted); font-size: 0.9rem; margin-bottom: 8px; }
        .trend-up { color: #28a745; font-weight: 600; }
        .trend-down { color: #dc3545; font-weight: 600; }
        .trend-stable { color: #ffc107; font-weight: 600; }
        .marketing-card { background: var(--card-bg); border-radius: 16px; border: 1px solid var(--border); padding: 24px; margin-bottom: 24px; }
        .marketing-card h5 { color: var(--accent2); margin-bottom: 20px; font-weight: 600; }
        .data-table { background: var(--card-bg); border-radius: 12px; overflow: hidden; }
        .table-dark { --bs-table-bg: var(--card-bg); --bs-table-border-color: var(--border); }
        .form-control, .form-select { background: var(--main-bg); border: 1px solid var(--border); color: var(--text); }
        .form-control:focus, .form-select:focus { background: var(--main-bg); border-color: var(--accent); color: var(--text); box-shadow: 0 0 0 0.2rem rgba(124, 58, 237, 0.25); }
        .btn-primary { background: var(--accent); border-color: var(--accent); }
        .btn-primary:hover { background: #6d28d9; border-color: #6d28d9; }
        .btn-success:hover { background: #1e7e34; }
        .btn-warning:hover { background: #d39e00; }
        .btn-info:hover { background: #138496; }
        .btn-danger:hover { background: #c82333; }
        .progress-custom { background: rgba(255,255,255,0.1); height: 8px; border-radius: 4px; overflow: hidden; }
        .progress-bar-custom { height: 100%; transition: width 0.3s ease; }
        .modal-content { background: var(--card-bg); border: 1px solid var(--border); }
        .modal-header { border-bottom: 1px solid var(--border); }
        .modal-footer { border-top: 1px solid var(--border); }
        .kpi-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px; margin-bottom: 32px; }
        .metric-card { background: rgba(255,255,255,0.05); border-radius: 8px; padding: 16px; margin-bottom: 12px; }
        .campaign-card { background: linear-gradient(135deg, var(--accent), var(--accent2)); border-radius: 12px; padding: 20px; color: white; margin-bottom: 20px; }
        .seo-score { font-size: 3rem; font-weight: 800; }
        .keyword-rank { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; font-weight: 600; }
        .rank-1-10 { background: #28a745; color: white; }
        .rank-11-30 { background: #ffc107; color: black; }
        .rank-31-100 { background: #dc3545; color: white; }
        .social-card { border-left: 4px solid var(--accent2); }

        @media (max-width: 900px) { .sidebar { width: 80px; } .main-container { margin-left: 80px; } .sidebar .nav-item { padding: 12px 10px; font-size: 0.95rem; } .sidebar .logo { font-size: 1.1rem; } .kpi-grid { grid-template-columns: 1fr; } }
        @media (max-width: 700px) { .sidebar { display: none; } .main-container { margin-left: 0; } .main-header { padding: 12px 10px; } .content-wrapper { padding: 12px 4px; } }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="logo">
            <i class="fas fa-hotel"></i> LUXSTAFF
        </div>
        <a href="#roleSection" class="nav-item active" onclick="showSection('roleSection')"><i class="fas fa-user-tie"></i> Vai tr√≤</a>
        <a href="#dashboardSection" class="nav-item" onclick="showSection('dashboardSection')"><i class="fas fa-chart-line"></i> Dashboard</a>
        <a href="#campaignsSection" class="nav-item" onclick="showSection('campaignsSection')"><i class="fas fa-bullhorn"></i> Campaigns</a>
        <a href="#seoSection" class="nav-item" onclick="showSection('seoSection')"><i class="fas fa-search"></i> SEO</a>
        <a href="#socialSection" class="nav-item" onclick="showSection('socialSection')"><i class="fas fa-share-alt"></i> Social Media</a>
        <a href="#analyticsSection" class="nav-item" onclick="showSection('analyticsSection')"><i class="fas fa-chart-bar"></i> Analytics</a>
        <a href="#settingsSection" class="nav-item" onclick="showSection('settingsSection')"><i class="fas fa-cogs"></i> C√†i ƒë·∫∑t</a>
        <div class="sidebar-footer">
            <button class="btn" onclick="logout()"><i class="fas fa-sign-out-alt me-2"></i> ƒêƒÉng xu·∫•t</button>
        </div>
    </div>
    <div class="main-container">
        <header class="main-header">
            <h1 class="h4 mb-0" style="color:var(--accent2);">Nh√¢n vi√™n marketing / SEO</h1>
            <div class="user-info">
                <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Avatar">
                <span><strong>Marketing / SEO</strong></span>
            </div>
        </header>
        <main class="content-wrapper">
            <!-- Section Vai tr√≤ (m·∫∑c ƒë·ªãnh) -->
            <div id="roleSection" class="content-section active">
                <!-- KPI Overview -->
                <section class="mb-4">
                    <div class="kpi-grid">
                        <div class="stat-card">
                            <div class="stat-number" style="color: var(--accent2);">125K</div>
                            <div class="stat-label">Website Traffic th√°ng</div>
                            <small class="trend-up"><i class="fas fa-arrow-up"></i> +28.5%</small>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: #28a745;">3.2%</div>
                            <div class="stat-label">Conversion Rate</div>
                            <small class="trend-up"><i class="fas fa-arrow-up"></i> +0.8%</small>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: #ffc107;">‚Ç´89M</div>
                            <div class="stat-label">Ad Spend th√°ng</div>
                            <small class="trend-stable"><i class="fas fa-minus"></i> 0.0%</small>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: #17a2b8;">4.2x</div>
                            <div class="stat-label">ROAS (Return on Ad Spend)</div>
                            <small class="trend-up"><i class="fas fa-arrow-up"></i> +0.3x</small>
                        </div>
                    </div>
                </section>

                <section>
                    <div class="card-modern mb-4">
                        <div class="card-body profile-info">
                            <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Avatar">
                            <div class="info">
                                <h4 class="mb-1" style="color:var(--accent2);">Nh√¢n vi√™n Marketing / SEO</h4>
                                <div><i class="fas fa-briefcase me-2"></i> T·ªëi ∆∞u qu·∫£ng b√°, ch∆∞∆°ng tr√¨nh khuy·∫øn m√£i</div>
                                <hr style="border-color: var(--border); margin: 16px 0;">
                                <div>
                                    <strong style="color: var(--accent2);">Ch·ª©c nƒÉng ch√≠nh:</strong>
                                    <ul style="margin: 8px 0; padding-left: 20px;">
                                        <li>Qu·∫£n l√Ω campaigns qu·∫£ng c√°o (Google Ads, Facebook Ads)</li>
                                        <li>T·ªëi ∆∞u SEO v√† t·ª´ kh√≥a t√¨m ki·∫øm</li>
                                        <li>Qu·∫£n l√Ω social media v√† content marketing</li>
                                        <li>Ph√¢n t√≠ch hi·ªáu qu·∫£ marketing v√† ROI</li>
                                        <li>T·∫°o v√† qu·∫£n l√Ω ch∆∞∆°ng tr√¨nh khuy·∫øn m√£i</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Section Dashboard -->
            <div id="dashboardSection" class="content-section">
                <div class="row g-4">
                    <div class="col-md-8">
                        <div class="marketing-card">
                            <h5><i class="fas fa-chart-line me-2"></i>Traffic Overview h√¥m nay</h5>
                            <div class="row text-center">
                                <div class="col-3">
                                    <div class="stat-number text-primary">4,250</div>
                                    <small>Visitors</small>
                                </div>
                                <div class="col-3">
                                    <div class="stat-number text-success">156</div>
                                    <small>Conversions</small>
                                </div>
                                <div class="col-3">
                                    <div class="stat-number text-warning">3.7%</div>
                                    <small>CVR</small>
                                </div>
                                <div class="col-3">
                                    <div class="stat-number text-info">‚Ç´2.8M</div>
                                    <small>Ad Spend</small>
                                </div>
                            </div>
                            <div class="progress-custom mt-3">
                                <div class="progress-bar-custom" style="width: 67%; background: var(--accent2);"></div>
                            </div>
                            <small class="text-muted">Target h√¥m nay: 6,000 visitors</small>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="marketing-card">
                            <h5><i class="fas fa-bullhorn me-2"></i>Active Campaigns</h5>
                            <div class="metric-card">
                                <div class="d-flex justify-content-between">
                                    <span>Google Ads</span>
                                    <span class="badge bg-success">Live</span>
                                </div>
                                <small class="text-muted">Budget: ‚Ç´50K/day</small>
                            </div>
                            <div class="metric-card">
                                <div class="d-flex justify-content-between">
                                    <span>Facebook Ads</span>
                                    <span class="badge bg-success">Live</span>
                                </div>
                                <small class="text-muted">Budget: ‚Ç´30K/day</small>
                            </div>
                            <div class="metric-card">
                                <div class="d-flex justify-content-between">
                                    <span>Instagram Ads</span>
                                    <span class="badge bg-warning">Paused</span>
                                </div>
                                <small class="text-muted">Budget: ‚Ç´20K/day</small>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row g-4 mt-2">
                    <div class="col-md-6">
                        <div class="marketing-card">
                            <h5>Top Performing Keywords</h5>
                            <div class="metric-card">
                                <div class="d-flex justify-content-between">
                                    <span>kh√°ch s·∫°n h√† n·ªôi</span>
                                    <span class="keyword-rank rank-1-10">#3</span>
                                </div>
                                <small class="text-success">1,250 clicks/th√°ng</small>
                            </div>
                            <div class="metric-card">
                                <div class="d-flex justify-content-between">
                                    <span>resort ƒë√† n·∫µng</span>
                                    <span class="keyword-rank rank-1-10">#7</span>
                                </div>
                                <small class="text-success">890 clicks/th√°ng</small>
                            </div>
                            <div class="metric-card">
                                <div class="d-flex justify-content-between">
                                    <span>kh√°ch s·∫°n 5 sao</span>
                                    <span class="keyword-rank rank-11-30">#15</span>
                                </div>
                                <small class="text-warning">650 clicks/th√°ng</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="marketing-card">
                            <h5>Recent Activities</h5>
                            <div class="metric-card">
                                <div class="d-flex justify-content-between">
                                    <span><i class="fas fa-play text-success me-2"></i>Campaign started</span>
                                    <small>2h ago</small>
                                </div>
                                <small class="text-muted">Summer Promotion 2025</small>
                            </div>
                            <div class="metric-card">
                                <div class="d-flex justify-content-between">
                                    <span><i class="fas fa-edit text-info me-2"></i>SEO updated</span>
                                    <small>4h ago</small>
                                </div>
                                <small class="text-muted">Meta descriptions optimized</small>
                            </div>
                            <div class="metric-card">
                                <div class="d-flex justify-content-between">
                                    <span><i class="fas fa-share text-primary me-2"></i>Social post</span>
                                    <small>6h ago</small>
                                </div>
                                <small class="text-muted">Instagram story published</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Campaigns -->
            <div id="campaignsSection" class="content-section">
                <div class="marketing-card">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h5><i class="fas fa-bullhorn me-2"></i>Qu·∫£n l√Ω Campaigns</h5>
                        <div>
                            <button class="btn btn-success btn-sm me-2" onclick="createCampaign()">
                                <i class="fas fa-plus"></i> T·∫°o Campaign
                            </button>
                            <button class="btn btn-info btn-sm" onclick="campaignTemplates()">
                                <i class="fas fa-template"></i> Templates
                            </button>
                        </div>
                    </div>

                    <!-- Active Campaigns -->
                    <div class="row g-3 mb-4">
                        <div class="col-md-4">
                            <div class="campaign-card">
                                <div class="d-flex justify-content-between align-items-start mb-2">
                                    <h6 class="mb-0">Summer Promotion 2025</h6>
                                    <span class="badge bg-light text-dark">Google Ads</span>
                                </div>
                                <div class="row text-center">
                                    <div class="col-6">
                                        <div class="h5 mb-0">‚Ç´45K</div>
                                        <small>Daily Budget</small>
                                    </div>
                                    <div class="col-6">
                                        <div class="h5 mb-0">4.5x</div>
                                        <small>ROAS</small>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <button class="btn btn-light btn-sm me-2" onclick="editCampaign('summer2025')">Edit</button>
                                    <button class="btn btn-outline-light btn-sm" onclick="pauseCampaign('summer2025')">Pause</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="campaign-card" style="background: linear-gradient(135deg, #28a745, #20c997);">
                                <div class="d-flex justify-content-between align-items-start mb-2">
                                    <h6 class="mb-0">Facebook Retargeting</h6>
                                    <span class="badge bg-light text-dark">Facebook</span>
                                </div>
                                <div class="row text-center">
                                    <div class="col-6">
                                        <div class="h5 mb-0">‚Ç´30K</div>
                                        <small>Daily Budget</small>
                                    </div>
                                    <div class="col-6">
                                        <div class="h5 mb-0">6.2x</div>
                                        <small>ROAS</small>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <button class="btn btn-light btn-sm me-2" onclick="editCampaign('fb-retarget')">Edit</button>
                                    <button class="btn btn-outline-light btn-sm" onclick="pauseCampaign('fb-retarget')">Pause</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="campaign-card" style="background: linear-gradient(135deg, #ffc107, #fd7e14);">
                                <div class="d-flex justify-content-between align-items-start mb-2">
                                    <h6 class="mb-0">Brand Awareness</h6>
                                    <span class="badge bg-light text-dark">Instagram</span>
                                </div>
                                <div class="row text-center">
                                    <div class="col-6">
                                        <div class="h5 mb-0">‚Ç´25K</div>
                                        <small>Daily Budget</small>
                                    </div>
                                    <div class="col-6">
                                        <div class="h5 mb-0">2.8x</div>
                                        <small>ROAS</small>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <button class="btn btn-light btn-sm me-2" onclick="editCampaign('brand-awareness')">Edit</button>
                                    <button class="btn btn-outline-light btn-sm" onclick="pauseCampaign('brand-awareness')">Pause</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Campaign Performance Table -->
                    <div class="data-table">
                        <table class="table table-dark table-hover">
                            <thead>
                                <tr>
                                    <th>Campaign Name</th>
                                    <th>Platform</th>
                                    <th>Status</th>
                                    <th>Budget</th>
                                    <th>Spent</th>
                                    <th>Clicks</th>
                                    <th>Conversions</th>
                                    <th>ROAS</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Summer Promotion 2025</td>
                                    <td><i class="fab fa-google me-1"></i>Google Ads</td>
                                    <td><span class="badge bg-success">Active</span></td>
                                    <td>‚Ç´45,000/day</td>
                                    <td>‚Ç´42,500</td>
                                    <td>1,250</td>
                                    <td>56</td>
                                    <td class="text-success">4.5x</td>
                                    <td>
                                        <button class="btn btn-sm btn-info me-1" title="Edit"><i class="fas fa-edit"></i></button>
                                        <button class="btn btn-sm btn-warning me-1" title="Pause"><i class="fas fa-pause"></i></button>
                                        <button class="btn btn-sm btn-danger" title="Delete"><i class="fas fa-trash"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Facebook Retargeting</td>
                                    <td><i class="fab fa-facebook me-1"></i>Facebook</td>
                                    <td><span class="badge bg-success">Active</span></td>
                                    <td>‚Ç´30,000/day</td>
                                    <td>‚Ç´28,750</td>
                                    <td>890</td>
                                    <td>78</td>
                                    <td class="text-success">6.2x</td>
                                    <td>
                                        <button class="btn btn-sm btn-info me-1" title="Edit"><i class="fas fa-edit"></i></button>
                                        <button class="btn btn-sm btn-warning me-1" title="Pause"><i class="fas fa-pause"></i></button>
                                        <button class="btn btn-sm btn-danger" title="Delete"><i class="fas fa-trash"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Brand Awareness</td>
                                    <td><i class="fab fa-instagram me-1"></i>Instagram</td>
                                    <td><span class="badge bg-warning">Paused</span></td>
                                    <td>‚Ç´25,000/day</td>
                                    <td>‚Ç´0</td>
                                    <td>0</td>
                                    <td>0</td>
                                    <td class="text-muted">N/A</td>
                                    <td>
                                        <button class="btn btn-sm btn-success me-1" title="Resume" onclick="resumeCampaign('brand-awareness')"><i class="fas fa-play"></i></button>
                                        <button class="btn btn-sm btn-info me-1" title="Edit"><i class="fas fa-edit"></i></button>
                                        <button class="btn btn-sm btn-danger" title="Delete"><i class="fas fa-trash"></i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Section SEO -->
            <div id="seoSection" class="content-section">
                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="marketing-card text-center">
                            <h5><i class="fas fa-search me-2"></i>SEO Score</h5>
                            <div class="seo-score text-success">87</div>
                            <small class="text-muted">Overall Health Score</small>
                            <div class="progress-custom mt-3">
                                <div class="progress-bar-custom" style="width: 87%; background: #28a745;"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <div class="marketing-card">
                            <h5>SEO Tasks & Recommendations</h5>
                            <div class="metric-card">
                                <div class="d-flex justify-content-between">
                                    <span><i class="fas fa-exclamation-triangle text-warning me-2"></i>Fix missing meta descriptions</span>
                                    <span class="badge bg-warning">High Priority</span>
                                </div>
                                <small class="text-muted">12 pages missing meta descriptions</small>
                            </div>
                            <div class="metric-card">
                                <div class="d-flex justify-content-between">
                                    <span><i class="fas fa-image text-info me-2"></i>Optimize image alt texts</span>
                                    <span class="badge bg-info">Medium</span>
                                </div>
                                <small class="text-muted">45 images without alt text</small>
                            </div>
                            <div class="metric-card">
                                <div class="d-flex justify-content-between">
                                    <span><i class="fas fa-link text-success me-2"></i>Build internal links</span>
                                    <span class="badge bg-success">Low Priority</span>
                                </div>
                                <small class="text-muted">Improve internal linking structure</small>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row g-4 mt-2">
                    <div class="col-md-6">
                        <div class="marketing-card">
                            <h5>Keyword Rankings</h5>
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <span>Target Keywords: 24</span>
                                <button class="btn btn-sm btn-primary" onclick="addKeyword()">
                                    <i class="fas fa-plus"></i> Add Keyword
                                </button>
                            </div>
                            <div class="data-table">
                                <table class="table table-dark table-sm">
                                    <thead>
                                        <tr>
                                            <th>Keyword</th>
                                            <th>Position</th>
                                            <th>Change</th>
                                            <th>Volume</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>kh√°ch s·∫°n h√† n·ªôi</td>
                                            <td><span class="keyword-rank rank-1-10">#3</span></td>
                                            <td class="text-success">+2</td>
                                            <td>8,200</td>
                                        </tr>
                                        <tr>
                                            <td>resort ƒë√† n·∫µng</td>
                                            <td><span class="keyword-rank rank-1-10">#7</span></td>
                                            <td class="text-success">+1</td>
                                            <td>5,100</td>
                                        </tr>
                                        <tr>
                                            <td>kh√°ch s·∫°n 5 sao</td>
                                            <td><span class="keyword-rank rank-11-30">#15</span></td>
                                            <td class="text-danger">-3</td>
                                            <td>12,400</td>
                                        </tr>
                                        <tr>
                                            <td>booking kh√°ch s·∫°n</td>
                                            <td><span class="keyword-rank rank-31-100">#45</span></td>
                                            <td class="text-success">+8</td>
                                            <td>15,600</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="marketing-card">
                            <h5>Content Optimization</h5>
                            <div class="mb-3">
                                <label class="form-label">Page URL</label>
                                <input type="url" class="form-control" placeholder="https://luxhaven.com/hotels" id="pageUrl">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Target Keyword</label>
                                <input type="text" class="form-control" placeholder="kh√°ch s·∫°n luxury" id="targetKeyword">
                            </div>
                            <button class="btn btn-primary me-2" onclick="analyzeContent()">
                                <i class="fas fa-search"></i> Analyze Page
                            </button>
                            <button class="btn btn-success" onclick="optimizePage()">
                                <i class="fas fa-magic"></i> Auto Optimize
                            </button>
                            
                            <div class="mt-4">
                                <h6>Recent Optimizations</h6>
                                <div class="metric-card">
                                    <small class="text-success">‚úì Updated meta title - Hotel Luxury Page</small>
                                </div>
                                <div class="metric-card">
                                    <small class="text-success">‚úì Added structured data - Review schema</small>
                                </div>
                                <div class="metric-card">
                                    <small class="text-warning">‚ö† Needs improvement - Page loading speed</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Social Media -->
            <div id="socialSection" class="content-section">
                <div class="marketing-card">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h5><i class="fas fa-share-alt me-2"></i>Social Media Management</h5>
                        <div>
                            <button class="btn btn-success btn-sm me-2" onclick="createPost()">
                                <i class="fas fa-plus"></i> Create Post
                            </button>
                            <button class="btn btn-info btn-sm" onclick="schedulePost()">
                                <i class="fas fa-calendar"></i> Schedule
                            </button>
                        </div>
                    </div>

                    <!-- Social Media Stats -->
                    <div class="row g-3 mb-4">
                        <div class="col-md-3">
                            <div class="social-card metric-card">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <i class="fab fa-facebook fa-2x text-primary"></i>
                                        <div class="h5 mt-2 mb-0">25.4K</div>
                                        <small>Followers</small>
                                    </div>
                                    <div class="text-end">
                                        <div class="text-success">+450</div>
                                        <small>This month</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="social-card metric-card">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <i class="fab fa-instagram fa-2x text-danger"></i>
                                        <div class="h5 mt-2 mb-0">18.7K</div>
                                        <small>Followers</small>
                                    </div>
                                    <div class="text-end">
                                        <div class="text-success">+320</div>
                                        <small>This month</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="social-card metric-card">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <i class="fab fa-youtube fa-2x text-danger"></i>
                                        <div class="h5 mt-2 mb-0">8.9K</div>
                                        <small>Subscribers</small>
                                    </div>
                                    <div class="text-end">
                                        <div class="text-success">+120</div>
                                        <small>This month</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="social-card metric-card">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <i class="fab fa-tiktok fa-2x text-dark"></i>
                                        <div class="h5 mt-2 mb-0">12.3K</div>
                                        <small>Followers</small>
                                    </div>
                                    <div class="text-end">
                                        <div class="text-success">+890</div>
                                        <small>This month</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Posts & Engagement -->
                    <div class="row g-4">
                        <div class="col-md-6">
                            <div class="metric-card">
                                <h6>Recent Posts</h6>
                                <div class="metric-card">
                                    <div class="d-flex justify-content-between">
                                        <span><i class="fab fa-facebook me-2 text-primary"></i>Summer promotion launch</span>
                                        <small>2h ago</small>
                                    </div>
                                    <div class="d-flex justify-content-between mt-2">
                                        <span>üëç 245 | üí¨ 32 | üîÑ 18</span>
                                        <span class="text-success">High engagement</span>
                                    </div>
                                </div>
                                <div class="metric-card">
                                    <div class="d-flex justify-content-between">
                                        <span><i class="fab fa-instagram me-2 text-danger"></i>Beach resort story</span>
                                        <small>4h ago</small>
                                    </div>
                                    <div class="d-flex justify-content-between mt-2">
                                        <span>‚ù§Ô∏è 189 | üí¨ 24 | üì§ 12</span>
                                        <span class="text-warning">Medium engagement</span>
                                    </div>
                                </div>
                                <div class="metric-card">
                                    <div class="d-flex justify-content-between">
                                        <span><i class="fab fa-youtube me-2 text-danger"></i>Hotel tour video</span>
                                        <small>1d ago</small>
                                    </div>
                                    <div class="d-flex justify-content-between mt-2">
                                        <span>üëç 567 | üí¨ 89 | üëÅ 2.4K</span>
                                        <span class="text-success">Viral potential</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="metric-card">
                                <h6>Content Calendar</h6>
                                <div class="metric-card">
                                    <div class="d-flex justify-content-between">
                                        <span><i class="fas fa-calendar me-2 text-info"></i>Aug 4, 9:00 AM</span>
                                        <span class="badge bg-primary">Facebook</span>
                                    </div>
                                    <small class="text-muted">Weekend getaway promotion</small>
                                </div>
                                <div class="metric-card">
                                    <div class="d-flex justify-content-between">
                                        <span><i class="fas fa-calendar me-2 text-info"></i>Aug 4, 2:00 PM</span>
                                        <span class="badge bg-danger">Instagram</span>
                                    </div>
                                    <small class="text-muted">Behind the scenes - Hotel staff</small>
                                </div>
                                <div class="metric-card">
                                    <div class="d-flex justify-content-between">
                                        <span><i class="fas fa-calendar me-2 text-info"></i>Aug 5, 10:00 AM</span>
                                        <span class="badge bg-dark">TikTok</span>
                                    </div>
                                    <small class="text-muted">Quick hotel room tour</small>
                                </div>
                                <button class="btn btn-sm btn-outline-primary mt-2 w-100" onclick="viewFullCalendar()">
                                    View Full Calendar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Analytics -->
            <div id="analyticsSection" class="content-section">
                <div class="marketing-card">
                    <h5><i class="fas fa-chart-bar me-2"></i>Marketing Analytics</h5>
                    
                    <!-- Key Metrics -->
                    <div class="row g-3 mb-4">
                        <div class="col-md-3">
                            <div class="stat-card">
                                <div class="stat-number text-primary" id="totalRevenue">‚Ç´0M</div>
                                <div class="stat-label">Revenue from Marketing</div>
                                <small class="trend-up"><i class="fas fa-arrow-up"></i> +22%</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card">
                                <div class="stat-number text-success" id="totalROAS">0x</div>
                                <div class="stat-label">Average ROAS</div>
                                <small class="trend-up"><i class="fas fa-arrow-up"></i> +0.3x</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card">
                                <div class="stat-number text-warning" id="totalSpend">‚Ç´0M</div>
                                <div class="stat-label">Total Ad Spend</div>
                                <small class="trend-stable"><i class="fas fa-minus"></i> 0%</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card">
                                <div class="stat-number text-info" id="conversionRate">0%</div>
                                <div class="stat-label">Conversion Rate</div>
                                <small class="trend-down"><i class="fas fa-arrow-down"></i> -0.5%</small>
                            </div>
                        </div>
                    </div>

                    <!-- Notes & Notifications Overview -->
                    <div class="row g-4 mb-4">
                        <div class="col-md-6">
                            <div class="metric-card">
                                <h6><i class="fas fa-sticky-note me-2"></i>Recent Notes & Comments</h6>
                                <div id="recentNotesList">
                                    <div class="metric-card">
                                        <div class="d-flex justify-content-between">
                                            <span><i class="fas fa-user me-2"></i>Customer Note</span>
                                            <small>2h ago</small>
                                        </div>
                                        <small class="text-muted">"ko h√∫t thu·ªëc"</small>
                                    </div>
                                    <div class="metric-card">
                                        <div class="d-flex justify-content-between">
                                            <span><i class="fas fa-user me-2"></i>Application Note</span>
                                            <small>1d ago</small>
                                        </div>
                                        <small class="text-muted">"t√¥i mu·ªën ·ª©ng tuy·ªÉn"</small>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <button class="btn btn-sm btn-primary" onclick="viewAllNotes()">
                                        <i class="fas fa-eye"></i> View All Notes
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="metric-card">
                                <h6><i class="fas fa-bell me-2"></i>Recent Notifications</h6>
                                <div id="recentNotificationsList">
                                    <div class="metric-card">
                                        <div class="d-flex justify-content-between">
                                            <span><i class="fas fa-check-circle text-success me-2"></i>Payment Success</span>
                                            <small>1h ago</small>
                                        </div>
                                        <small class="text-muted">B·∫°n ƒë√£ thanh to√°n th√†nh c√¥ng ƒë∆°n h√†ng</small>
                                    </div>
                                    <div class="metric-card">
                                        <div class="d-flex justify-content-between">
                                            <span><i class="fas fa-star text-warning me-2"></i>Points Added</span>
                                            <small>3h ago</small>
                                        </div>
                                        <small class="text-muted">ƒê√£ c·ªông ƒëi·ªÉm th√†nh vi√™n: +11 ƒëi·ªÉm</small>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <button class="btn btn-sm btn-success" onclick="viewAllNotifications()">
                                        <i class="fas fa-list"></i> View All Notifications
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Affiliate Partners Overview -->
                    <div class="row g-4 mb-4">
                        <div class="col-md-6">
                            <div class="metric-card">
                                <h6><i class="fas fa-handshake me-2"></i>Affiliate Partners Overview</h6>
                                <div class="row text-center">
                                    <div class="col-4">
                                        <div class="h4 mb-0" id="totalPartners">0</div>
                                        <small>Total Partners</small>
                                    </div>
                                    <div class="col-4">
                                        <div class="h4 mb-0 text-success" id="activePartners">0</div>
                                        <small>Active Partners</small>
                                    </div>
                                    <div class="col-4">
                                        <div class="h4 mb-0 text-warning" id="partnerRevenue">‚Ç´0M</div>
                                        <small>Total Revenue</small>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <button class="btn btn-sm btn-primary" onclick="viewAllPartners()">
                                        <i class="fas fa-eye"></i> View All Partners
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="metric-card">
                                <h6><i class="fas fa-money-bill-wave me-2"></i>Commission Overview</h6>
                                <div class="row text-center">
                                    <div class="col-4">
                                        <div class="h4 mb-0 text-info" id="totalCommissions">‚Ç´0</div>
                                        <small>Total Commissions</small>
                                    </div>
                                    <div class="col-4">
                                        <div class="h4 mb-0 text-warning" id="pendingCommissions">0</div>
                                        <small>Pending</small>
                                    </div>
                                    <div class="col-4">
                                        <div class="h4 mb-0 text-success" id="paidCommissions">0</div>
                                        <small>Paid</small>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <button class="btn btn-sm btn-success" onclick="viewAllCommissions()">
                                        <i class="fas fa-list"></i> View All Commissions
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Channel Performance -->
                    <div class="row g-4">
                        <div class="col-md-8">
                            <div class="metric-card">
                                <h6>Channel Performance</h6>
                                <div class="data-table">
                                    <table class="table table-dark table-sm">
                                        <thead>
                                            <tr>
                                                <th>Channel</th>
                                                <th>Spend</th>
                                                <th>Revenue</th>
                                                <th>ROAS</th>
                                                <th>CPA</th>
                                                <th>Performance</th>
                                            </tr>
                                        </thead>
                                        <tbody id="channelPerformanceTable">
                                            <tr>
                                                <td><i class="fab fa-google me-2"></i>Google Ads</td>
                                                <td>‚Ç´45M</td>
                                                <td>‚Ç´189M</td>
                                                <td class="text-success">4.2x</td>
                                                <td>‚Ç´285K</td>
                                                <td><span class="badge bg-success">Excellent</span></td>
                                            </tr>
                                            <tr>
                                                <td><i class="fab fa-facebook me-2"></i>Facebook Ads</td>
                                                <td>‚Ç´28M</td>
                                                <td>‚Ç´126M</td>
                                                <td class="text-success">4.5x</td>
                                                <td>‚Ç´320K</td>
                                                <td><span class="badge bg-success">Excellent</span></td>
                                            </tr>
                                            <tr>
                                                <td><i class="fab fa-instagram me-2"></i>Instagram Ads</td>
                                                <td>‚Ç´16M</td>
                                                <td>‚Ç´59M</td>
                                                <td class="text-warning">3.7x</td>
                                                <td>‚Ç´420K</td>
                                                <td><span class="badge bg-warning">Good</span></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="metric-card">
                                <h6>Top Converting Keywords</h6>
                                <div id="topKeywordsList">
                                    <div class="metric-card">
                                        <div class="d-flex justify-content-between">
                                            <span>kh√°ch s·∫°n h√† n·ªôi</span>
                                            <span class="text-success">156 conv.</span>
                                        </div>
                                        <small class="text-muted">CPA: ‚Ç´275K</small>
                                    </div>
                                    <div class="metric-card">
                                        <div class="d-flex justify-content-between">
                                            <span>resort ƒë√† n·∫µng</span>
                                            <span class="text-success">89 conv.</span>
                                        </div>
                                        <small class="text-muted">CPA: ‚Ç´320K</small>
                                    </div>
                                    <div class="metric-card">
                                        <div class="d-flex justify-content-between">
                                            <span>kh√°ch s·∫°n 5 sao</span>
                                            <span class="text-success">67 conv.</span>
                                        </div>
                                        <small class="text-muted">CPA: ‚Ç´450K</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Settings -->
            <div id="settingsSection" class="content-section">
                <div class="marketing-card">
                    <h5><i class="fas fa-cogs me-2"></i>Marketing Settings</h5>
                    
                    <div class="row g-4">
                        <!-- Ad Account Settings -->
                        <div class="col-md-6">
                            <div class="metric-card">
                                <h6><i class="fas fa-link me-2"></i>Ad Account Connections</h6>
                                <div class="metric-card">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span><i class="fab fa-google me-2"></i>Google Ads</span>
                                        <span class="badge bg-success">Connected</span>
                                    </div>
                                    <small class="text-muted">Account: luxury-haven-hotels</small>
                                </div>
                                <div class="metric-card">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span><i class="fab fa-facebook me-2"></i>Facebook Business</span>
                                        <span class="badge bg-success">Connected</span>
                                    </div>
                                    <small class="text-muted">Account: LuxHaven Travel</small>
                                </div>
                                <div class="metric-card">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span><i class="fab fa-google me-2"></i>Google Analytics</span>
                                        <span class="badge bg-warning">Needs Refresh</span>
                                    </div>
                                    <small class="text-muted">Last sync: 2 days ago</small>
                                </div>
                                <button class="btn btn-primary btn-sm">Manage Connections</button>
                            </div>
                        </div>

                        <!-- Budget & Bidding -->
                        <div class="col-md-6">
                            <div class="metric-card">
                                <h6><i class="fas fa-dollar-sign me-2"></i>Budget & Bidding</h6>
                                <div class="mb-3">
                                    <label class="form-label">Daily Budget Limit</label>
                                    <div class="input-group">
                                        <span class="input-group-text">‚Ç´</span>
                                        <input type="number" class="form-control" value="100000">
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Auto-bidding Strategy</label>
                                    <select class="form-select">
                                        <option value="maximize-conversions" selected>Maximize Conversions</option>
                                        <option value="target-cpa">Target CPA</option>
                                        <option value="target-roas">Target ROAS</option>
                                        <option value="manual-cpc">Manual CPC</option>
                                    </select>
                                </div>
                                <button class="btn btn-success btn-sm">Save Settings</button>
                            </div>
                        </div>
                    </div>

                    <!-- Automation Settings -->
                    <div class="row g-4 mt-2">
                        <div class="col-md-12">
                            <div class="metric-card">
                                <h6><i class="fas fa-robot me-2"></i>Automation Rules</h6>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input" type="checkbox" id="autoIncreaseBudget" checked>
                                            <label class="form-check-label" for="autoIncreaseBudget">
                                                Auto-increase budget for high ROAS campaigns
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input" type="checkbox" id="autoPauseLowPerform" checked>
                                            <label class="form-check-label" for="autoPauseLowPerform">
                                                Auto-pause low performing ads
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input" type="checkbox" id="autoOptimizeKeywords">
                                            <label class="form-check-label" for="autoOptimizeKeywords">
                                                Auto-optimize keyword bids
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <button class="btn btn-info btn-sm mt-3">Update Automation</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Section navigation
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all nav links
            document.querySelectorAll('.nav-item').forEach(link => {
                link.classList.remove('active');
            });
            
            // Show selected section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.add('active');
            }
            
            // Add active class to clicked nav link
            if (event && event.target) {
                event.target.classList.add('active');
            }
        }

        // Campaign Management Functions
        function createCampaign() {
            const modal = `
                <div class="modal fade" id="createCampaignModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content bg-dark">
                            <div class="modal-header">
                                <h5 class="modal-title">T·∫°o Campaign M·ªõi</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <form>
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <label class="form-label">Campaign Name</label>
                                            <input type="text" class="form-control" placeholder="Summer Promotion 2025">
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Platform</label>
                                            <select class="form-select">
                                                <option value="google">Google Ads</option>
                                                <option value="facebook">Facebook Ads</option>
                                                <option value="instagram">Instagram Ads</option>
                                                <option value="youtube">YouTube Ads</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Daily Budget</label>
                                            <div class="input-group">
                                                <span class="input-group-text">‚Ç´</span>
                                                <input type="number" class="form-control" placeholder="50000">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Campaign Type</label>
                                            <select class="form-select">
                                                <option value="search">Search Campaign</option>
                                                <option value="display">Display Campaign</option>
                                                <option value="shopping">Shopping Campaign</option>
                                                <option value="video">Video Campaign</option>
                                            </select>
                                        </div>
                                        <div class="col-12">
                                            <label class="form-label">Target Keywords</label>
                                            <textarea class="form-control" rows="3" placeholder="kh√°ch s·∫°n h√† n·ªôi, resort ƒë√† n·∫µng, kh√°ch s·∫°n 5 sao"></textarea>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                                <button type="button" class="btn btn-success" onclick="saveCampaign()">T·∫°o Campaign</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modal);
            new bootstrap.Modal(document.getElementById('createCampaignModal')).show();
        }

        function editCampaign(campaignId) {
            showNotification('Editing campaign: ' + campaignId, 'info');
        }

        function pauseCampaign(campaignId) {
            showNotification('Campaign paused: ' + campaignId, 'warning');
        }

        function resumeCampaign(campaignId) {
            showNotification('Campaign resumed: ' + campaignId, 'success');
        }

        function saveCampaign() {
            showNotification('Campaign created successfully!', 'success');
            bootstrap.Modal.getInstance(document.getElementById('createCampaignModal')).hide();
        }

        // SEO Functions
        function addKeyword() {
            const modal = `
                <div class="modal fade" id="addKeywordModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content bg-dark">
                            <div class="modal-header">
                                <h5 class="modal-title">Th√™m Keyword M·ªõi</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <form>
                                    <div class="mb-3">
                                        <label class="form-label">Keyword</label>
                                        <input type="text" class="form-control" placeholder="kh√°ch s·∫°n luxury">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Target URL</label>
                                        <input type="url" class="form-control" placeholder="https://luxhaven.com/hotels">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Priority</label>
                                        <select class="form-select">
                                            <option value="high">High</option>
                                            <option value="medium" selected>Medium</option>
                                            <option value="low">Low</option>
                                        </select>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                                <button type="button" class="btn btn-primary" onclick="saveKeyword()">Th√™m Keyword</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modal);
            new bootstrap.Modal(document.getElementById('addKeywordModal')).show();
        }

        function analyzeContent() {
            const pageUrl = document.getElementById('pageUrl').value;
            const keyword = document.getElementById('targetKeyword').value;
            
            if (!pageUrl || !keyword) {
                showNotification('Please enter both page URL and target keyword', 'warning');
                return;
            }
            
            showNotification('Analyzing content for: ' + keyword, 'info');
            
            // Simulate analysis delay
            setTimeout(() => {
                showNotification('Analysis complete! SEO score: 78/100', 'success');
            }, 2000);
        }

        function optimizePage() {
            showNotification('Auto-optimization started...', 'info');
            
            setTimeout(() => {
                showNotification('Page optimized successfully! SEO score improved to 85/100', 'success');
            }, 3000);
        }

        function saveKeyword() {
            showNotification('Keyword added successfully!', 'success');
            bootstrap.Modal.getInstance(document.getElementById('addKeywordModal')).hide();
        }

        // Social Media Functions
        function createPost() {
            const modal = `
                <div class="modal fade" id="createPostModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content bg-dark">
                            <div class="modal-header">
                                <h5 class="modal-title">T·∫°o Post M·ªõi</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <form>
                                    <div class="mb-3">
                                        <label class="form-label">Platforms</label>
                                        <div class="d-flex gap-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="facebook" id="facebook">
                                                <label class="form-check-label" for="facebook">
                                                    <i class="fab fa-facebook me-1"></i> Facebook
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="instagram" id="instagram">
                                                <label class="form-check-label" for="instagram">
                                                    <i class="fab fa-instagram me-1"></i> Instagram
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="youtube" id="youtube">
                                                <label class="form-check-label" for="youtube">
                                                    <i class="fab fa-youtube me-1"></i> YouTube
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Post Content</label>
                                        <textarea class="form-control" rows="4" placeholder="Kh√°m ph√° nh·ªØng tr·∫£i nghi·ªám tuy·ªát v·ªùi t·∫°i LuxHaven..."></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Media Upload</label>
                                        <input type="file" class="form-control" multiple accept="image/*,video/*">
                                    </div>
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <label class="form-label">Publish Time</label>
                                            <select class="form-select">
                                                <option value="now">Publish Now</option>
                                                <option value="schedule">Schedule</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Hashtags</label>
                                            <input type="text" class="form-control" placeholder="#LuxHaven #Travel #Hotel">
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                                <button type="button" class="btn btn-success" onclick="publishPost()">Publish</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modal);
            new bootstrap.Modal(document.getElementById('createPostModal')).show();
        }

        function schedulePost() {
            showNotification('Opening content calendar...', 'info');
        }

        function publishPost() {
            showNotification('Post published successfully across selected platforms!', 'success');
            bootstrap.Modal.getInstance(document.getElementById('createPostModal')).hide();
        }

        function viewFullCalendar() {
            showNotification('Opening full content calendar...', 'info');
        }

        // Template Functions
        function campaignTemplates() {
            const modal = `
                <div class="modal fade" id="templateModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content bg-dark">
                            <div class="modal-header">
                                <h5 class="modal-title">Campaign Templates</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <div class="card bg-secondary h-100">
                                            <div class="card-body">
                                                <h6 class="card-title">Summer Vacation</h6>
                                                <p class="card-text">Template for summer travel promotions</p>
                                                <button class="btn btn-primary btn-sm" onclick="useTemplate('summer')">Use Template</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card bg-secondary h-100">
                                            <div class="card-body">
                                                <h6 class="card-title">Business Travel</h6>
                                                <p class="card-text">Template for business traveler campaigns</p>
                                                <button class="btn btn-primary btn-sm" onclick="useTemplate('business')">Use Template</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card bg-secondary h-100">
                                            <div class="card-body">
                                                <h6 class="card-title">Weekend Getaway</h6>
                                                <p class="card-text">Template for weekend travel offers</p>
                                                <button class="btn btn-primary btn-sm" onclick="useTemplate('weekend')">Use Template</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card bg-secondary h-100">
                                            <div class="card-body">
                                                <h6 class="card-title">Luxury Experience</h6>
                                                <p class="card-text">Template for luxury hotel campaigns</p>
                                                <button class="btn btn-primary btn-sm" onclick="useTemplate('luxury')">Use Template</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modal);
            new bootstrap.Modal(document.getElementById('templateModal')).show();
        }

        function useTemplate(templateType) {
            showNotification('Template applied: ' + templateType, 'success');
            bootstrap.Modal.getInstance(document.getElementById('templateModal')).hide();
        }

        // Utility Functions
        function showNotification(message, type = 'info') {
            const alertClass = {
                'success': 'alert-success',
                'warning': 'alert-warning',
                'error': 'alert-danger',
                'info': 'alert-info'
            }[type] || 'alert-info';
            
            const notification = document.createElement('div');
            notification.className = `alert ${alertClass} alert-dismissible fade show position-fixed`;
            notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
            notification.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDuX4_RKARM7g0K3BvoZPS8ADxVgrYQKYc",
            authDomain: "websitedatphongkhachsan.firebaseapp.com",
            databaseURL: "https://websitedatphongkhachsan-default-rtdb.firebaseio.com",
            projectId: "websitedatphongkhachsan",
            storageBucket: "websitedatphongkhachsan.appspot.com",
            messagingSenderId: "732884739524",
            appId: "1:732884739524:web:a9c34746f5704a9c3eb091",
            measurementId: "G-RC61EXTZH7"
        };

        // Kh·ªüi t·∫°o Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // ===== FIREBASE DATA MANAGEMENT =====
        
        // Bi·∫øn l∆∞u tr·ªØ d·ªØ li·ªáu
        let marketingCampaigns = [];
        let affiliatePartners = [];
        let affiliateCampaigns = [];
        let affiliateCommissions = [];
        let marketingAnalytics = {
            totalRevenue: 0,
            totalSpend: 0,
            totalBookings: 0,
            conversionRate: 0,
            roas: 0
        };
        let allNotes = [];
        let allNotifications = [];
        let allBookings = [];

        // Load d·ªØ li·ªáu t·ª´ Firebase
        function loadMarketingData() {
            console.log('üîÑ Loading marketing data from Firebase...');
            
            // Load affiliate campaigns
            const campaignsRef = database.ref('affiliateCampaigns');
            campaignsRef.once('value')
                .then((snapshot) => {
                    affiliateCampaigns = [];
                    snapshot.forEach((childSnapshot) => {
                        affiliateCampaigns.push({
                            id: childSnapshot.key,
                            ...childSnapshot.val()
                        });
                    });
                    console.log(`‚úÖ Loaded ${affiliateCampaigns.length} affiliate campaigns`);
                    updateCampaignsDisplay();
                })
                .catch((error) => {
                    console.warn('‚ö†Ô∏è Error loading affiliate campaigns:', error);
                });

            // Load affiliate partners
            const partnersRef = database.ref('affiliatePartners');
            partnersRef.once('value')
                .then((snapshot) => {
                    affiliatePartners = [];
                    snapshot.forEach((childSnapshot) => {
                        affiliatePartners.push({
                            id: childSnapshot.key,
                            ...childSnapshot.val()
                        });
                    });
                    console.log(`‚úÖ Loaded ${affiliatePartners.length} affiliate partners`);
                    updateAffiliateStats();
                })
                .catch((error) => {
                    console.warn('‚ö†Ô∏è Error loading affiliate partners:', error);
                });

            // Load affiliate commissions
            const commissionsRef = database.ref('affiliateCommissions');
            commissionsRef.once('value')
                .then((snapshot) => {
                    affiliateCommissions = [];
                    snapshot.forEach((childSnapshot) => {
                        affiliateCommissions.push({
                            id: childSnapshot.key,
                            ...childSnapshot.val()
                        });
                    });
                    console.log(`‚úÖ Loaded ${affiliateCommissions.length} affiliate commissions`);
                    updateCommissionStats();
                })
                .catch((error) => {
                    console.warn('‚ö†Ô∏è Error loading affiliate commissions:', error);
                });

            // Load bookings data for analytics and notes
            const bookingsRef = database.ref('bookings');
            bookingsRef.once('value')
                .then((snapshot) => {
                    allBookings = [];
                    snapshot.forEach((childSnapshot) => {
                        allBookings.push({
                            id: childSnapshot.key,
                            ...childSnapshot.val()
                        });
                    });
                    console.log(`‚úÖ Loaded ${allBookings.length} bookings`);
                    calculateMarketingAnalytics(allBookings);
                    updateNotesDisplay();
                })
                .catch((error) => {
                    console.warn('‚ö†Ô∏è Error loading bookings:', error);
                });

            // Load notifications
            const notificationsRef = database.ref('notifications');
            notificationsRef.once('value')
                .then((snapshot) => {
                    allNotifications = [];
                    snapshot.forEach((childSnapshot) => {
                        const userNotifications = childSnapshot.val();
                        Object.keys(userNotifications).forEach(notificationId => {
                            allNotifications.push({
                                id: notificationId,
                                userId: childSnapshot.key,
                                ...userNotifications[notificationId]
                            });
                        });
                    });
                    console.log(`‚úÖ Loaded ${allNotifications.length} notifications`);
                    updateNotificationsDisplay();
                })
                .catch((error) => {
                    console.warn('‚ö†Ô∏è Error loading notifications:', error);
                });

            // Load admin notifications
            const adminNotificationsRef = database.ref('adminNotifications');
            adminNotificationsRef.once('value')
                .then((snapshot) => {
                    snapshot.forEach((childSnapshot) => {
                        allNotifications.push({
                            id: childSnapshot.key,
                            type: 'admin',
                            ...childSnapshot.val()
                        });
                    });
                    console.log(`‚úÖ Loaded admin notifications`);
                    updateNotificationsDisplay();
                })
                .catch((error) => {
                    console.warn('‚ö†Ô∏è Error loading admin notifications:', error);
                });
        }

        // C·∫≠p nh·∫≠t hi·ªÉn th·ªã notes
        function updateNotesDisplay() {
            const recentNotesList = document.getElementById('recentNotesList');
            if (!recentNotesList) return;

            // Collect notes from bookings
            const bookingNotes = allBookings
                .filter(booking => booking.note && booking.note.trim())
                .map(booking => ({
                    type: 'Customer Note',
                    content: booking.note,
                    timestamp: booking.createdAt,
                    source: 'Booking',
                    bookingId: booking.id
                }));

            // Collect notes from applications
            const applicationNotes = allBookings
                .filter(booking => booking.note && booking.note.includes('·ª©ng tuy·ªÉn'))
                .map(booking => ({
                    type: 'Application Note',
                    content: booking.note,
                    timestamp: booking.createdAt,
                    source: 'Application',
                    bookingId: booking.id
                }));

            // Combine and sort by timestamp
            allNotes = [...bookingNotes, ...applicationNotes]
                .sort((a, b) => b.timestamp - a.timestamp)
                .slice(0, 5); // Show only 5 most recent

            // Update display
            recentNotesList.innerHTML = allNotes.map(note => `
                <div class="metric-card">
                    <div class="d-flex justify-content-between">
                        <span><i class="fas fa-user me-2"></i>${note.type}</span>
                        <small>${formatTimeAgo(note.timestamp)}</small>
                    </div>
                    <small class="text-muted">"${note.content}"</small>
                </div>
            `).join('');
        }

        // C·∫≠p nh·∫≠t hi·ªÉn th·ªã notifications
        function updateNotificationsDisplay() {
            const recentNotificationsList = document.getElementById('recentNotificationsList');
            if (!recentNotificationsList) return;

            // Sort notifications by timestamp
            const recentNotifications = allNotifications
                .sort((a, b) => b.timestamp - a.timestamp)
                .slice(0, 5); // Show only 5 most recent

            // Update display
            recentNotificationsList.innerHTML = recentNotifications.map(notification => {
                let icon = 'fas fa-bell';
                let color = 'text-info';
                
                if (notification.message?.includes('thanh to√°n th√†nh c√¥ng')) {
                    icon = 'fas fa-check-circle';
                    color = 'text-success';
                } else if (notification.message?.includes('ƒëi·ªÉm th√†nh vi√™n')) {
                    icon = 'fas fa-star';
                    color = 'text-warning';
                } else if (notification.message?.includes('c·∫©m nang')) {
                    icon = 'fas fa-book';
                    color = 'text-primary';
                }

                return `
                    <div class="metric-card">
                        <div class="d-flex justify-content-between">
                            <span><i class="${icon} ${color} me-2"></i>${getNotificationTitle(notification)}</span>
                            <small>${formatTimeAgo(notification.timestamp)}</small>
                        </div>
                        <small class="text-muted">${notification.message || 'No message'}</small>
                    </div>
                `;
            }).join('');
        }

        // Get notification title
        function getNotificationTitle(notification) {
            if (notification.message?.includes('thanh to√°n th√†nh c√¥ng')) {
                return 'Payment Success';
            } else if (notification.message?.includes('ƒëi·ªÉm th√†nh vi√™n')) {
                return 'Points Added';
            } else if (notification.message?.includes('c·∫©m nang')) {
                return 'Content Pending';
            } else if (notification.type === 'admin') {
                return 'Admin Notification';
            }
            return 'System Notification';
        }

        // Format time ago
        function formatTimeAgo(timestamp) {
            if (!timestamp) return 'Unknown time';
            
            const now = Date.now();
            const diff = now - timestamp;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);

            if (minutes < 1) return 'Just now';
            if (minutes < 60) return `${minutes}m ago`;
            if (hours < 24) return `${hours}h ago`;
            return `${days}d ago`;
        }

        // Xem t·∫•t c·∫£ notes
        function viewAllNotes() {
            const modal = `
                <div class="modal fade" id="allNotesModal" tabindex="-1">
                    <div class="modal-dialog modal-xl">
                        <div class="modal-content bg-dark">
                            <div class="modal-header">
                                <h5 class="modal-title">T·∫•t c·∫£ Notes & Comments</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="data-table">
                                    <table class="table table-dark table-hover">
                                        <thead>
                                            <tr>
                                                <th>Type</th>
                                                <th>Content</th>
                                                <th>Source</th>
                                                <th>Time</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="allNotesTableBody">
                                            ${allNotes.map(note => `
                                                <tr>
                                                    <td><span class="badge bg-info">${note.type}</span></td>
                                                    <td>${note.content}</td>
                                                    <td>${note.source}</td>
                                                    <td>${formatTimeAgo(note.timestamp)}</td>
                                                    <td>
                                                        <button class="btn btn-sm btn-info me-1" onclick="viewNoteDetails('${note.bookingId}')">
                                                            <i class="fas fa-eye"></i>
                                                        </button>
                                                        <button class="btn btn-sm btn-warning" onclick="addNoteToCampaign('${note.content}')">
                                                            <i class="fas fa-plus"></i>
                                                        </button>
                                                    </td>
                                                </tr>
                                            `).join('')}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modal);
            new bootstrap.Modal(document.getElementById('allNotesModal')).show();
        }

        // Xem t·∫•t c·∫£ notifications
        function viewAllNotifications() {
            const modal = `
                <div class="modal fade" id="allNotificationsModal" tabindex="-1">
                    <div class="modal-dialog modal-xl">
                        <div class="modal-content bg-dark">
                            <div class="modal-header">
                                <h5 class="modal-title">T·∫•t c·∫£ Notifications</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="data-table">
                                    <table class="table table-dark table-hover">
                                        <thead>
                                            <tr>
                                                <th>Type</th>
                                                <th>Message</th>
                                                <th>Time</th>
                                                <th>Status</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="allNotificationsTableBody">
                                            ${allNotifications.map(notification => `
                                                <tr>
                                                    <td><span class="badge bg-primary">${getNotificationTitle(notification)}</span></td>
                                                    <td>${notification.message || 'No message'}</td>
                                                    <td>${formatTimeAgo(notification.timestamp)}</td>
                                                    <td><span class="badge ${notification.isRead ? 'bg-success' : 'bg-warning'}">${notification.isRead ? 'Read' : 'Unread'}</span></td>
                                                    <td>
                                                        <button class="btn btn-sm btn-info me-1" onclick="markAsRead('${notification.id}')" ${notification.isRead ? 'disabled' : ''}>
                                                            <i class="fas fa-check"></i>
                                                        </button>
                                                        <button class="btn btn-sm btn-warning" onclick="viewNotificationDetails('${notification.id}')">
                                                            <i class="fas fa-eye"></i>
                                                        </button>
                                                    </td>
                                                </tr>
                                            `).join('')}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modal);
            new bootstrap.Modal(document.getElementById('allNotificationsModal')).show();
        }

        // Mark notification as read
        function markAsRead(notificationId) {
            const notification = allNotifications.find(n => n.id === notificationId);
            if (!notification) return;

            if (notification.type === 'admin') {
                database.ref(`adminNotifications/${notificationId}`).update({
                    isRead: true,
                    updatedAt: new Date().toISOString()
                }).then(() => {
                    showNotification('Notification marked as read', 'success');
                    loadMarketingData(); // Reload data
                }).catch((error) => {
                    showNotification('Error updating notification', 'error');
                    console.error('Error:', error);
                });
            } else {
                database.ref(`notifications/${notification.userId}/${notificationId}`).update({
                    isRead: true,
                    updatedAt: new Date().toISOString()
                }).then(() => {
                    showNotification('Notification marked as read', 'success');
                    loadMarketingData(); // Reload data
                }).catch((error) => {
                    showNotification('Error updating notification', 'error');
                    console.error('Error:', error);
                });
            }
        }

        // View notification details
        function viewNotificationDetails(notificationId) {
            const notification = allNotifications.find(n => n.id === notificationId);
            if (!notification) return;

            const modal = `
                <div class="modal fade" id="notificationDetailsModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content bg-dark">
                            <div class="modal-header">
                                <h5 class="modal-title">Notification Details</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Type</label>
                                        <p class="form-control-plaintext">${getNotificationTitle(notification)}</p>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Status</label>
                                        <p class="form-control-plaintext">
                                            <span class="badge ${notification.isRead ? 'bg-success' : 'bg-warning'}">${notification.isRead ? 'Read' : 'Unread'}</span>
                                        </p>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">Message</label>
                                        <p class="form-control-plaintext">${notification.message || 'No message'}</p>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Created At</label>
                                        <p class="form-control-plaintext">${new Date(notification.timestamp).toLocaleString()}</p>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">User ID</label>
                                        <p class="form-control-plaintext">${notification.userId || 'System'}</p>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                ${!notification.isRead ? 
                                    `<button type="button" class="btn btn-success" onclick="markAsRead('${notification.id}')">Mark as Read</button>` : 
                                    ''
                                }
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modal);
            new bootstrap.Modal(document.getElementById('notificationDetailsModal')).show();
        }

        // Add note to campaign
        function addNoteToCampaign(noteContent) {
            const modal = `
                <div class="modal fade" id="addNoteToCampaignModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content bg-dark">
                            <div class="modal-header">
                                <h5 class="modal-title">Add Note to Campaign</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <form id="addNoteForm">
                                    <div class="mb-3">
                                        <label class="form-label">Campaign</label>
                                        <select class="form-select" id="targetCampaign" required>
                                            <option value="">Select Campaign</option>
                                            ${affiliateCampaigns.map(campaign => 
                                                `<option value="${campaign.id}">${campaign.name}</option>`
                                            ).join('')}
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Note Content</label>
                                        <textarea class="form-control" id="campaignNote" rows="3" required>${noteContent}</textarea>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                <button type="button" class="btn btn-primary" onclick="saveNoteToCampaign()">Add Note</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modal);
            new bootstrap.Modal(document.getElementById('addNoteToCampaignModal')).show();
        }

        // Save note to campaign
        function saveNoteToCampaign() {
            const form = document.getElementById('addNoteForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const campaignId = document.getElementById('targetCampaign').value;
            const noteContent = document.getElementById('campaignNote').value;

            database.ref(`affiliateCampaigns/${campaignId}/notes`).push({
                content: noteContent,
                createdAt: new Date().toISOString(),
                createdBy: 'Marketing Team'
            }).then(() => {
                showNotification('Note added to campaign successfully!', 'success');
                bootstrap.Modal.getInstance(document.getElementById('addNoteToCampaignModal')).hide();
                document.getElementById('addNoteToCampaignModal').remove();
                loadMarketingData(); // Reload data
            }).catch((error) => {
                showNotification('Error adding note to campaign', 'error');
                console.error('Error:', error);
            });
        }

        // C·∫≠p nh·∫≠t hi·ªÉn th·ªã campaigns
        function updateCampaignsDisplay() {
            const campaignsContainer = document.querySelector('#campaignsSection .row.g-3');
            if (!campaignsContainer) return;

            // Clear existing campaigns
            const existingCards = campaignsContainer.querySelectorAll('.col-md-4');
            existingCards.forEach(card => card.remove());

            // Add real campaigns from Firebase
            affiliateCampaigns.forEach(campaign => {
                const campaignCard = createCampaignCard(campaign);
                campaignsContainer.appendChild(campaignCard);
            });

            // Update campaign performance table
            updateCampaignPerformanceTable();
        }

        // T·∫°o campaign card t·ª´ d·ªØ li·ªáu Firebase
        function createCampaignCard(campaign) {
            const col = document.createElement('div');
            col.className = 'col-md-4';
            
            const statusColor = campaign.status === 'ƒêang ch·∫°y' ? 'bg-success' : 'bg-warning';
            const roas = campaign.revenue && campaign.revenue !== '0ƒë' ? 
                (parseFloat(campaign.revenue.replace(/[^\d]/g, '')) / parseFloat(campaign.commission || 1)).toFixed(1) + 'x' : 'N/A';
            
            col.innerHTML = `
                <div class="campaign-card">
                    <div class="d-flex justify-content-between align-items-start mb-2">
                        <h6 class="mb-0">${campaign.name}</h6>
                        <span class="badge bg-light text-dark">${campaign.partner}</span>
                    </div>
                    <div class="row text-center">
                        <div class="col-6">
                            <div class="h5 mb-0">‚Ç´${campaign.commission || 0}K</div>
                            <small>Commission</small>
                        </div>
                        <div class="col-6">
                            <div class="h5 mb-0">${roas}</div>
                            <small>ROAS</small>
                        </div>
                    </div>
                    <div class="mt-3">
                        <button class="btn btn-light btn-sm me-2" onclick="editCampaign('${campaign.id}')">Edit</button>
                        <button class="btn btn-outline-light btn-sm" onclick="toggleCampaignStatus('${campaign.id}')">
                            ${campaign.status === 'ƒêang ch·∫°y' ? 'Pause' : 'Resume'}
                        </button>
                    </div>
                </div>
            `;
            
            return col;
        }

        // C·∫≠p nh·∫≠t b·∫£ng performance campaigns
        function updateCampaignPerformanceTable() {
            const tableBody = document.querySelector('#campaignsSection tbody');
            if (!tableBody) return;

            tableBody.innerHTML = '';
            
            affiliateCampaigns.forEach(campaign => {
                const row = document.createElement('tr');
                const statusBadge = campaign.status === 'ƒêang ch·∫°y' ? 
                    '<span class="badge bg-success">Active</span>' : 
                    '<span class="badge bg-warning">Paused</span>';
                
                row.innerHTML = `
                    <td>${campaign.name}</td>
                    <td><i class="fab fa-google me-1"></i>${campaign.partner}</td>
                    <td>${statusBadge}</td>
                    <td>‚Ç´${campaign.commission || 0}K/day</td>
                    <td>‚Ç´${campaign.revenue || '0'}</td>
                    <td>${campaign.clicks || 0}</td>
                    <td>${campaign.bookings || 0}</td>
                    <td class="text-success">${campaign.commission || 0}%</td>
                    <td>
                        <button class="btn btn-sm btn-info me-1" title="Edit" onclick="editCampaign('${campaign.id}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-warning me-1" title="Toggle" onclick="toggleCampaignStatus('${campaign.id}')">
                            <i class="fas fa-pause"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" title="Delete" onclick="deleteCampaign('${campaign.id}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Toggle campaign status
        function toggleCampaignStatus(campaignId) {
            const campaign = affiliateCampaigns.find(c => c.id === campaignId);
            if (!campaign) return;

            const newStatus = campaign.status === 'ƒêang ch·∫°y' ? 'T·∫°m d·ª´ng' : 'ƒêang ch·∫°y';
            
            database.ref(`affiliateCampaigns/${campaignId}`).update({
                status: newStatus,
                updatedAt: new Date().toISOString()
            }).then(() => {
                showNotification(`Campaign ${campaign.name} ${newStatus}`, 'success');
                loadMarketingData(); // Reload data
            }).catch((error) => {
                showNotification('Error updating campaign status', 'error');
                console.error('Error:', error);
            });
        }

        // X√≥a campaign
        function deleteCampaign(campaignId) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a campaign n√†y?')) return;

            database.ref(`affiliateCampaigns/${campaignId}`).remove()
                .then(() => {
                    showNotification('Campaign ƒë√£ ƒë∆∞·ª£c x√≥a', 'success');
                    loadMarketingData(); // Reload data
                })
                .catch((error) => {
                    showNotification('Error deleting campaign', 'error');
                    console.error('Error:', error);
                });
        }

        // C·∫≠p nh·∫≠t th·ªëng k√™ affiliate
        function updateAffiliateStats() {
            const totalPartners = affiliatePartners.length;
            const activePartners = affiliatePartners.filter(p => p.status === 'ƒêang h·ª£p t√°c').length;
            const totalRevenue = affiliatePartners.reduce((sum, p) => sum + parseFloat(p.revenue || 0), 0);

            // Update stats display
            const statsElements = document.querySelectorAll('.stat-number');
            if (statsElements.length >= 4) {
                statsElements[0].textContent = totalPartners;
                statsElements[1].textContent = activePartners;
                statsElements[2].textContent = `‚Ç´${(totalRevenue / 1000000).toFixed(1)}M`;
                statsElements[3].textContent = `${((activePartners / totalPartners) * 100).toFixed(1)}%`;
            }

            // Update affiliate partners overview
            const totalPartnersEl = document.getElementById('totalPartners');
            const activePartnersEl = document.getElementById('activePartners');
            const partnerRevenueEl = document.getElementById('partnerRevenue');

            if (totalPartnersEl) totalPartnersEl.textContent = totalPartners;
            if (activePartnersEl) activePartnersEl.textContent = activePartners;
            if (partnerRevenueEl) partnerRevenueEl.textContent = `‚Ç´${(totalRevenue / 1000000).toFixed(1)}M`;
        }

        // C·∫≠p nh·∫≠t th·ªëng k√™ commission
        function updateCommissionStats() {
            const totalCommissions = affiliateCommissions.reduce((sum, c) => {
                return sum + parseFloat(c.commission?.replace(/[^\d]/g, '') || 0);
            }, 0);

            const pendingCommissions = affiliateCommissions.filter(c => c.status === 'Ch·ªù thanh to√°n').length;
            const paidCommissions = affiliateCommissions.filter(c => c.status === 'ƒê√£ thanh to√°n').length;

            // Update commission overview
            const totalCommissionsEl = document.getElementById('totalCommissions');
            const pendingCommissionsEl = document.getElementById('pendingCommissions');
            const paidCommissionsEl = document.getElementById('paidCommissions');

            if (totalCommissionsEl) totalCommissionsEl.textContent = `‚Ç´${(totalCommissions / 1000).toFixed(0)}K`;
            if (pendingCommissionsEl) pendingCommissionsEl.textContent = pendingCommissions;
            if (paidCommissionsEl) paidCommissionsEl.textContent = paidCommissions;

            console.log('üìä Commission Stats:', {
                total: totalCommissions,
                pending: pendingCommissions,
                paid: paidCommissions
            });
        }

        // T√≠nh to√°n marketing analytics t·ª´ bookings
        function calculateMarketingAnalytics(bookings) {
            const totalRevenue = bookings.reduce((sum, booking) => sum + (booking.totalPrice || 0), 0);
            const totalBookings = bookings.length;
            const conversionRate = totalBookings > 0 ? (totalBookings / 1000) * 100 : 0; // Gi·∫£ ƒë·ªãnh 1000 visitors
            const totalSpend = totalRevenue * 0.3; // Gi·∫£ ƒë·ªãnh 30% chi ph√≠ marketing
            const roas = totalSpend > 0 ? totalRevenue / totalSpend : 0;

            marketingAnalytics = {
                totalRevenue,
                totalSpend,
                totalBookings,
                conversionRate,
                roas
            };

            updateAnalyticsDisplay();
        }

        // C·∫≠p nh·∫≠t hi·ªÉn th·ªã analytics
        function updateAnalyticsDisplay() {
            const analyticsSection = document.getElementById('analyticsSection');
            if (!analyticsSection) return;

            // Update KPI cards
            const totalRevenueEl = document.getElementById('totalRevenue');
            const totalROASEl = document.getElementById('totalROAS');
            const totalSpendEl = document.getElementById('totalSpend');
            const conversionRateEl = document.getElementById('conversionRate');

            if (totalRevenueEl) totalRevenueEl.textContent = `‚Ç´${(marketingAnalytics.totalRevenue / 1000000).toFixed(1)}M`;
            if (totalROASEl) totalROASEl.textContent = `${marketingAnalytics.roas.toFixed(1)}x`;
            if (totalSpendEl) totalSpendEl.textContent = `‚Ç´${(marketingAnalytics.totalSpend / 1000000).toFixed(1)}M`;
            if (conversionRateEl) conversionRateEl.textContent = `${marketingAnalytics.conversionRate.toFixed(1)}%`;
        }

        // Xem t·∫•t c·∫£ partners
        function viewAllPartners() {
            const modal = `
                <div class="modal fade" id="partnersModal" tabindex="-1">
                    <div class="modal-dialog modal-xl">
                        <div class="modal-content bg-dark">
                            <div class="modal-header">
                                <h5 class="modal-title">T·∫•t c·∫£ Affiliate Partners</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="data-table">
                                    <table class="table table-dark table-hover">
                                        <thead>
                                            <tr>
                                                <th>Partner Name</th>
                                                <th>Website</th>
                                                <th>Commission</th>
                                                <th>Revenue</th>
                                                <th>Status</th>
                                                <th>Contact</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="partnersTableBody">
                                            ${affiliatePartners.map(partner => `
                                                <tr>
                                                    <td>${partner.name}</td>
                                                    <td><a href="${partner.website}" target="_blank">${partner.website}</a></td>
                                                    <td>${partner.commission}%</td>
                                                    <td>‚Ç´${(parseFloat(partner.revenue || 0) / 1000000).toFixed(1)}M</td>
                                                    <td><span class="badge ${partner.status === 'ƒêang h·ª£p t√°c' ? 'bg-success' : 'bg-warning'}">${partner.status}</span></td>
                                                    <td>${partner.contactEmail}<br><small>${partner.contactPhone}</small></td>
                                                    <td>
                                                        <button class="btn btn-sm btn-info me-1" onclick="editPartner('${partner.id}')">
                                                            <i class="fas fa-edit"></i>
                                                        </button>
                                                        <button class="btn btn-sm btn-warning" onclick="togglePartnerStatus('${partner.id}')">
                                                            <i class="fas fa-toggle-on"></i>
                                                        </button>
                                                    </td>
                                                </tr>
                                            `).join('')}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modal);
            new bootstrap.Modal(document.getElementById('partnersModal')).show();
        }

        // Xem t·∫•t c·∫£ commissions
        function viewAllCommissions() {
            const modal = `
                <div class="modal fade" id="commissionsModal" tabindex="-1">
                    <div class="modal-dialog modal-xl">
                        <div class="modal-content bg-dark">
                            <div class="modal-header">
                                <h5 class="modal-title">T·∫•t c·∫£ Commissions</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="data-table">
                                    <table class="table table-dark table-hover">
                                        <thead>
                                            <tr>
                                                <th>Partner</th>
                                                <th>Month</th>
                                                <th>Revenue</th>
                                                <th>Commission</th>
                                                <th>Status</th>
                                                <th>Payment Date</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="commissionsTableBody">
                                            ${affiliateCommissions.map(commission => `
                                                <tr>
                                                    <td>${commission.partner}</td>
                                                    <td>${commission.month}</td>
                                                    <td>${commission.revenue}</td>
                                                    <td>${commission.commission}</td>
                                                    <td><span class="badge ${commission.status === 'ƒê√£ thanh to√°n' ? 'bg-success' : 'bg-warning'}">${commission.status}</span></td>
                                                    <td>${commission.paymentDate || 'N/A'}</td>
                                                    <td>
                                                        <button class="btn btn-sm btn-success me-1" onclick="markAsPaid('${commission.id}')" ${commission.status === 'ƒê√£ thanh to√°n' ? 'disabled' : ''}>
                                                            <i class="fas fa-check"></i>
                                                        </button>
                                                        <button class="btn btn-sm btn-info" onclick="viewCommissionDetails('${commission.id}')">
                                                            <i class="fas fa-eye"></i>
                                                        </button>
                                                    </td>
                                                </tr>
                                            `).join('')}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modal);
            new bootstrap.Modal(document.getElementById('commissionsModal')).show();
        }

        // Toggle partner status
        function togglePartnerStatus(partnerId) {
            const partner = affiliatePartners.find(p => p.id === partnerId);
            if (!partner) return;

            const newStatus = partner.status === 'ƒêang h·ª£p t√°c' ? 'T·∫°m d·ª´ng' : 'ƒêang h·ª£p t√°c';
            
            database.ref(`affiliatePartners/${partnerId}`).update({
                status: newStatus,
                updatedAt: new Date().toISOString()
            }).then(() => {
                showNotification(`Partner ${partner.name} status updated to ${newStatus}`, 'success');
                loadMarketingData(); // Reload data
            }).catch((error) => {
                showNotification('Error updating partner status', 'error');
                console.error('Error:', error);
            });
        }

        // Mark commission as paid
        function markAsPaid(commissionId) {
            database.ref(`affiliateCommissions/${commissionId}`).update({
                status: 'ƒê√£ thanh to√°n',
                paymentDate: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            }).then(() => {
                showNotification('Commission marked as paid', 'success');
                loadMarketingData(); // Reload data
            }).catch((error) => {
                showNotification('Error updating commission status', 'error');
                console.error('Error:', error);
            });
        }

        // View commission details
        function viewCommissionDetails(commissionId) {
            const commission = affiliateCommissions.find(c => c.id === commissionId);
            if (!commission) return;

            const modal = `
                <div class="modal fade" id="commissionDetailsModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content bg-dark">
                            <div class="modal-header">
                                <h5 class="modal-title">Commission Details</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Partner</label>
                                        <p class="form-control-plaintext">${commission.partner}</p>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Month</label>
                                        <p class="form-control-plaintext">${commission.month}</p>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Revenue</label>
                                        <p class="form-control-plaintext">${commission.revenue}</p>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Commission</label>
                                        <p class="form-control-plaintext">${commission.commission}</p>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Status</label>
                                        <p class="form-control-plaintext">
                                            <span class="badge ${commission.status === 'ƒê√£ thanh to√°n' ? 'bg-success' : 'bg-warning'}">${commission.status}</span>
                                        </p>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Payment Date</label>
                                        <p class="form-control-plaintext">${commission.paymentDate || 'N/A'}</p>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">Created At</label>
                                        <p class="form-control-plaintext">${new Date(commission.createdAt).toLocaleDateString()}</p>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                ${commission.status !== 'ƒê√£ thanh to√°n' ? 
                                    `<button type="button" class="btn btn-success" onclick="markAsPaid('${commission.id}')">Mark as Paid</button>` : 
                                    ''
                                }
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modal);
            new bootstrap.Modal(document.getElementById('commissionDetailsModal')).show();
        }

        // Edit partner
        function editPartner(partnerId) {
            const partner = affiliatePartners.find(p => p.id === partnerId);
            if (!partner) return;

            const modal = `
                <div class="modal fade" id="editPartnerModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content bg-dark">
                            <div class="modal-header">
                                <h5 class="modal-title">Edit Partner</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <form id="editPartnerForm">
                                    <div class="mb-3">
                                        <label class="form-label">Partner Name</label>
                                        <input type="text" class="form-control" id="editPartnerName" value="${partner.name}" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Website</label>
                                        <input type="url" class="form-control" id="editPartnerWebsite" value="${partner.website}" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Commission Rate (%)</label>
                                        <input type="number" class="form-control" id="editPartnerCommission" value="${partner.commission}" min="0" max="100" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Contact Email</label>
                                        <input type="email" class="form-control" id="editPartnerEmail" value="${partner.contactEmail}" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Contact Phone</label>
                                        <input type="tel" class="form-control" id="editPartnerPhone" value="${partner.contactPhone}" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Status</label>
                                        <select class="form-select" id="editPartnerStatus" required>
                                            <option value="ƒêang h·ª£p t√°c" ${partner.status === 'ƒêang h·ª£p t√°c' ? 'selected' : ''}>ƒêang h·ª£p t√°c</option>
                                            <option value="T·∫°m d·ª´ng" ${partner.status === 'T·∫°m d·ª´ng' ? 'selected' : ''}>T·∫°m d·ª´ng</option>
                                        </select>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                <button type="button" class="btn btn-primary" onclick="savePartnerChanges('${partnerId}')">Save Changes</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modal);
            new bootstrap.Modal(document.getElementById('editPartnerModal')).show();
        }

        // Save partner changes
        function savePartnerChanges(partnerId) {
            const form = document.getElementById('editPartnerForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const partnerData = {
                name: document.getElementById('editPartnerName').value,
                website: document.getElementById('editPartnerWebsite').value,
                commission: parseFloat(document.getElementById('editPartnerCommission').value),
                contactEmail: document.getElementById('editPartnerEmail').value,
                contactPhone: document.getElementById('editPartnerPhone').value,
                status: document.getElementById('editPartnerStatus').value,
                updatedAt: new Date().toISOString()
            };

            database.ref(`affiliatePartners/${partnerId}`).update(partnerData)
                .then(() => {
                    showNotification('Partner updated successfully!', 'success');
                    bootstrap.Modal.getInstance(document.getElementById('editPartnerModal')).hide();
                    document.getElementById('editPartnerModal').remove();
                    loadMarketingData(); // Reload data
                })
                .catch((error) => {
                    showNotification('Error updating partner', 'error');
                    console.error('Error:', error);
                });
        }

        // Real-time updates
        function setupRealTimeUpdates() {
            // Listen for affiliate campaigns changes
            database.ref('affiliateCampaigns').on('value', (snapshot) => {
                affiliateCampaigns = [];
                snapshot.forEach((childSnapshot) => {
                    affiliateCampaigns.push({
                        id: childSnapshot.key,
                        ...childSnapshot.val()
                    });
                });
                updateCampaignsDisplay();
            });

            // Listen for affiliate partners changes
            database.ref('affiliatePartners').on('value', (snapshot) => {
                affiliatePartners = [];
                snapshot.forEach((childSnapshot) => {
                    affiliatePartners.push({
                        id: childSnapshot.key,
                        ...childSnapshot.val()
                    });
                });
                updateAffiliateStats();
            });

            // Listen for bookings changes
            database.ref('bookings').on('value', (snapshot) => {
                const bookings = [];
                snapshot.forEach((childSnapshot) => {
                    bookings.push(childSnapshot.val());
                });
                calculateMarketingAnalytics(bookings);
            });
        }

        // Enhanced campaign creation with Firebase
        function createCampaign() {
            const modal = `
                <div class="modal fade" id="createCampaignModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content bg-dark">
                            <div class="modal-header">
                                <h5 class="modal-title">T·∫°o Campaign M·ªõi</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <form id="campaignForm">
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <label class="form-label">Campaign Name</label>
                                            <input type="text" class="form-control" id="campaignName" placeholder="Summer Promotion 2025" required>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Partner</label>
                                            <select class="form-select" id="campaignPartner" required>
                                                <option value="">Ch·ªçn partner</option>
                                                ${affiliatePartners.map(partner => 
                                                    `<option value="${partner.name}">${partner.name}</option>`
                                                ).join('')}
                                            </select>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Commission Rate (%)</label>
                                            <input type="number" class="form-control" id="campaignCommission" placeholder="5" min="0" max="100" required>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Target Bookings</label>
                                            <input type="number" class="form-control" id="campaignTarget" placeholder="100" min="1" required>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Start Date</label>
                                            <input type="date" class="form-control" id="campaignStartDate" required>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">End Date</label>
                                            <input type="date" class="form-control" id="campaignEndDate" required>
                                        </div>
                                        <div class="col-12">
                                            <label class="form-label">Description</label>
                                            <textarea class="form-control" id="campaignDescription" rows="3" placeholder="M√¥ t·∫£ campaign..."></textarea>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                                <button type="button" class="btn btn-success" onclick="saveCampaignToFirebase()">T·∫°o Campaign</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modal);
            new bootstrap.Modal(document.getElementById('createCampaignModal')).show();
        }

        // Save campaign to Firebase
        function saveCampaignToFirebase() {
            const form = document.getElementById('campaignForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const campaignData = {
                name: document.getElementById('campaignName').value,
                partner: document.getElementById('campaignPartner').value,
                commission: parseFloat(document.getElementById('campaignCommission').value),
                target: parseInt(document.getElementById('campaignTarget').value),
                startDate: document.getElementById('campaignStartDate').value,
                endDate: document.getElementById('campaignEndDate').value,
                description: document.getElementById('campaignDescription').value,
                status: 'ƒêang ch·∫°y',
                bookings: 0,
                clicks: 0,
                revenue: '0ƒë',
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            database.ref('affiliateCampaigns').push(campaignData)
                .then(() => {
                    showNotification('Campaign created successfully!', 'success');
                    bootstrap.Modal.getInstance(document.getElementById('createCampaignModal')).hide();
                    document.getElementById('createCampaignModal').remove();
                })
                .catch((error) => {
                    showNotification('Error creating campaign', 'error');
                    console.error('Error:', error);
                });
        }

        // Enhanced SEO functions with Firebase
        function addKeyword() {
            const modal = `
                <div class="modal fade" id="addKeywordModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content bg-dark">
                            <div class="modal-header">
                                <h5 class="modal-title">Th√™m Keyword M·ªõi</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <form id="keywordForm">
                                    <div class="mb-3">
                                        <label class="form-label">Keyword</label>
                                        <input type="text" class="form-control" id="keywordText" placeholder="kh√°ch s·∫°n luxury" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Target URL</label>
                                        <input type="url" class="form-control" id="keywordUrl" placeholder="https://luxhaven.com/hotels" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Priority</label>
                                        <select class="form-select" id="keywordPriority" required>
                                            <option value="high">High</option>
                                            <option value="medium" selected>Medium</option>
                                            <option value="low">Low</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Search Volume</label>
                                        <input type="number" class="form-control" id="keywordVolume" placeholder="1000" min="0">
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                                <button type="button" class="btn btn-primary" onclick="saveKeywordToFirebase()">Th√™m Keyword</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modal);
            new bootstrap.Modal(document.getElementById('addKeywordModal')).show();
        }

        // Save keyword to Firebase
        function saveKeywordToFirebase() {
            const form = document.getElementById('keywordForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const keywordData = {
                keyword: document.getElementById('keywordText').value,
                url: document.getElementById('keywordUrl').value,
                priority: document.getElementById('keywordPriority').value,
                volume: parseInt(document.getElementById('keywordVolume').value) || 0,
                position: 0,
                change: 0,
                createdAt: new Date().toISOString()
            };

            database.ref('seoKeywords').push(keywordData)
                .then(() => {
                    showNotification('Keyword added successfully!', 'success');
                    bootstrap.Modal.getInstance(document.getElementById('addKeywordModal')).hide();
                    document.getElementById('addKeywordModal').remove();
                })
                .catch((error) => {
                    showNotification('Error adding keyword', 'error');
                    console.error('Error:', error);
                });
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Load initial data
            loadMarketingData();
            
            // Setup real-time updates
            setupRealTimeUpdates();
            
            // Auto-refresh data every 30 seconds
            setInterval(() => {
                loadMarketingData();
            }, 30000);
            
            console.log('Marketing/SEO Dashboard loaded successfully with Firebase integration');
        });

        // ƒêƒÉng xu·∫•t v·ªõi Firebase Auth
        function logout() {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t?')) {
                // Ki·ªÉm tra xem Firebase Auth c√≥ s·∫µn kh√¥ng
                if (typeof firebase !== 'undefined' && firebase.auth) {
                    firebase.auth().signOut().then(() => {
                        console.log('ƒêƒÉng xu·∫•t th√†nh c√¥ng');
                        window.location.href = '../auth.html';
                    }).catch((error) => {
                        console.error('L·ªói ƒëƒÉng xu·∫•t:', error);
                        // V·∫´n chuy·ªÉn trang n·∫øu c√≥ l·ªói
                        window.location.href = '../auth.html';
                    });
                } else {
                    // Fallback n·∫øu Firebase kh√¥ng c√≥
                    window.location.href = '../auth.html';
                }
            }
        }

        // Export functions to global scope
        window.createCampaign = createCampaign;
        window.editCampaign = editCampaign;
        window.pauseCampaign = pauseCampaign;
        window.resumeCampaign = resumeCampaign;
        window.saveCampaign = saveCampaign;
        window.addKeyword = addKeyword;
        window.analyzeContent = analyzeContent;
        window.optimizePage = optimizePage;
        window.saveKeyword = saveKeyword;
        window.createPost = createPost;
        window.schedulePost = schedulePost;
        window.publishPost = publishPost;
        window.viewFullCalendar = viewFullCalendar;
        window.campaignTemplates = campaignTemplates;
        window.useTemplate = useTemplate;
        window.logout = logout;
        
        // New Firebase functions
        window.viewAllPartners = viewAllPartners;
        window.viewAllCommissions = viewAllCommissions;
        window.togglePartnerStatus = togglePartnerStatus;
        window.markAsPaid = markAsPaid;
        window.viewCommissionDetails = viewCommissionDetails;
        window.editPartner = editPartner;
        window.savePartnerChanges = savePartnerChanges;
        window.toggleCampaignStatus = toggleCampaignStatus;
        window.deleteCampaign = deleteCampaign;
        window.saveCampaignToFirebase = saveCampaignToFirebase;
        window.saveKeywordToFirebase = saveKeywordToFirebase;
        
        // Notes & Notifications functions
        window.viewAllNotes = viewAllNotes;
        window.viewAllNotifications = viewAllNotifications;
        window.markAsRead = markAsRead;
        window.viewNotificationDetails = viewNotificationDetails;
        window.addNoteToCampaign = addNoteToCampaign;
        window.saveNoteToCampaign = saveNoteToCampaign;
    </script>
</body>
</html>